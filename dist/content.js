/*! For license information please see content.js.LICENSE.txt */
(()=>{"use strict";var e={780:e=>{const t=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},n=({clearTimeout:e,setTimeout:n,willResolve:r})=>(i,{value:o,signal:s}={})=>{if(s&&s.aborted)return Promise.reject(t());let a,c,u;const l=e||clearTimeout,h=()=>{l(a),u(t())},d=new Promise(((e,t)=>{c=()=>{s&&s.removeEventListener("abort",h),r?e(o):t(o)},u=t,a=(n||setTimeout)(c,i)}));return s&&s.addEventListener("abort",h,{once:!0}),d.clear=()=>{l(a),a=null,c()},d},r=e=>{const t=n({...e,willResolve:!0});return t.reject=n({...e,willResolve:!1}),t.range=(e,n,r)=>t(((e,t)=>Math.floor(Math.random()*(t-e+1)+e))(e,n),r),t},i=r();i.createWithTimers=r,e.exports=i,e.exports.default=i},85:(e,t,n)=>{n.r(t),n.d(t,{TransportChromeExtension:()=>i});var r=n(525);class i{constructor(e,t){this.logger=e,this.recorder=t,this.events=new r.S,this.consoleAppEvent=this.events,this.connectHasBeenCalled=!1,this.context=r.T.CHROME_EXTENSION}connect(){return this.connectHasBeenCalled?Promise.reject(new r.J("Already connected",r.E.UNEXPECTED_ERROR)):(this.connectHasBeenCalled=!0,window.addEventListener("message-from-jabra-chrome-extension",(e=>{var t;let n=e.detail;this.recorder&&(n=null===(t=this.recorder)||void 0===t?void 0:t.recordInput(n)),this.events.next(n)})),this.writeAction({event:"ping"}),Promise.resolve())}static checkInstallation(){return(0,r._)(this,void 0,void 0,(function*(){return new Promise((e=>{const t=new CustomEvent("message-to-jabra-chrome-extension",{detail:"check-console-app-installation"});window.dispatchEvent(t),window.addEventListener("installation-status-from-jabra-chrome-extension",(t=>{e({ok:t.detail,message:t.detail?"Installation ok":"The Jabra Chromehost is not installed"})})),setTimeout((()=>{e({ok:!1,message:"The Jabra Chrome Extension is not installed"})}),3e3)}))}))}writeAction(e){var t;null===(t=this.recorder)||void 0===t||t.recordOutput(e),window.dispatchEvent(new CustomEvent("message-to-jabra-chrome-extension",{detail:e}))}}},525:(e,t,n)=>{function r(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function i(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function o(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}n.d(t,{C:()=>ir,E:()=>ke,I:()=>mn,J:()=>ct,L:()=>Le,O:()=>H,S:()=>F,T:()=>xe,W:()=>Tn,_:()=>r,a:()=>Te,b:()=>Se,c:()=>Ce,d:()=>j,e:()=>In,f:()=>Fn,g:()=>Pe,h:()=>Ue,i:()=>L,j:()=>An,k:()=>Cn,l:()=>ut,m:()=>Oe,n:()=>N,o:()=>k,p:()=>Fe,t:()=>Je,u:()=>Gt,v:()=>On,w:()=>Gn});var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function c(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function h(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}function d(e){return this instanceof d?(this.v=e,this):new d(e)}function p(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=i[e](t)).value instanceof d?Promise.resolve(n.value.v).then(c,u):l(o[0][2],n)}catch(e){l(o[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function f(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=u(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}function v(e){return"function"==typeof e}function E(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var g=E((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function b(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var w=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=u(o),a=s.next();!a.done;a=s.next())a.value.remove(this)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else o.remove(this);var c=this.initialTeardown;if(v(c))try{c()}catch(e){i=e instanceof g?e.errors:[e]}var d=this._teardowns;if(d){this._teardowns=null;try{for(var p=u(d),f=p.next();!f.done;f=p.next()){var E=f.value;try{_(E)}catch(e){i=null!=i?i:[],e instanceof g?i=h(h([],l(i)),l(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}}if(i)throw new g(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)_(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&b(t,e)},e.prototype.remove=function(t){var n=this._teardowns;n&&b(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),y=w.EMPTY;function m(e){return e instanceof w||e&&"closed"in e&&v(e.remove)&&v(e.add)&&v(e.unsubscribe)}function _(e){v(e)?e():e.unsubscribe()}function R(e){!function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];setTimeout.apply(void 0,h([],l(e)))}((function(){throw e}))}function N(){}var O=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,m(t)&&t.add(n)):n.destination=C,n}return a(t,e),t.create=function(e,t,n){return new T(e,t,n)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(w),T=function(e){function t(t,n,r){var i,o=e.call(this)||this;if(v(t))i=t;else if(t){var s;i=t.next,n=t.error,r=t.complete,s=t,i=null==i?void 0:i.bind(s),n=null==n?void 0:n.bind(s),r=null==r?void 0:r.bind(s)}return o.destination={next:i?I(i):N,error:I(null!=n?n:A),complete:r?I(r):N},o}return a(t,e),t}(O);function I(e,t){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{e.apply(void 0,h([],l(t)))}catch(e){R(e)}}}function A(e){throw e}var C={closed:!0,next:N,error:A,complete:N},D="function"==typeof Symbol&&Symbol.observable||"@@observable";function S(e){return e}function P(e){return 0===e.length?S:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var L=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=(r=e)&&r instanceof O||function(e){return e&&v(e.next)&&v(e.error)&&v(e.complete)}(r)&&m(r)?e:new T(e,t,n),o=this.operator,s=this.source;return i.add(o?o.call(i,s):s?this._subscribe(i):this._trySubscribe(i)),i},e.prototype._deprecatedSyncErrorSubscribe=function(e){var t=e;t._syncErrorHack_isSubscribing=!0;var n=this.operator;if(n)e.add(n.call(e,this.source));else try{e.add(this._subscribe(e))}catch(e){t.__syncError=e}for(var r=t;r;){if("__syncError"in r)try{throw r.__syncError}finally{e.unsubscribe()}r=r.destination}t._syncErrorHack_isSubscribing=!1},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=U(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(e){r(e),null==i||i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[D]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length?P(e)(this):this},e.prototype.toPromise=function(e){var t=this;return new(e=U(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function U(e){var t;return null!==(t=null!=e?e:undefined)&&void 0!==t?t:Promise}function k(e){return function(t){if(function(e){return v(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var H=function(e){function t(t,n,r,i,o){var s=e.call(this,t)||this;return s.onFinalize=o,s._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return a(t,e),t.prototype.unsubscribe=function(){var t,n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))},t}(O),x=E((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),F=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return a(t,e),t.prototype.lift=function(e){var t=new G(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new x},t.prototype.next=function(e){var t,n;if(this._throwIfClosed(),!this.isStopped){var r=this.observers.slice();try{for(var i=u(r),o=i.next();!o.done;o=i.next())o.value.next(e)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},t.prototype.error=function(e){if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;for(var t=this.observers;t.length;)t.shift().error(e)}},t.prototype.complete=function(){if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;for(var e=this.observers;e.length;)e.shift().complete()}},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=t.hasError,r=t.isStopped,i=t.observers;return n||r?y:(i.push(e),new w((function(){return b(i,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new L;return e.source=this,e},t.create=function(e,t){return new G(e,t)},t}(L),G=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return a(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:y},t}(F),M=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return a(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(F),B={now:function(){return(B.delegate||Date).now()},delegate:void 0},W=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=B);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return a(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,i=n._buffer,o=n._infiniteTimeWindow,s=n._timestampProvider,a=n._windowTime;r||(i.push(t),!o&&i.push(s.now()+a)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,i=e._infiniteTimeWindow,o=(i?1:2)*t;if(t<1/0&&o<r.length&&r.splice(0,r.length-o),!i){for(var s=n.now(),a=0,c=1;c<r.length&&r[c]<=s;c+=2)a=c;a&&r.splice(0,a+1)}},t}(F),V=function(e){function t(t,n){return e.call(this)||this}return a(t,e),t.prototype.schedule=function(e,t){return this},t}(w),Y=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return a(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return setInterval.apply(void 0,h([],l(e)))}(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;!function(e){clearInterval(e)}(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=!!e&&e||new Error(e)}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,b(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(V),K=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=B.now,e}(),j=new(function(e){function t(t,n){void 0===n&&(n=K.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r._scheduled=void 0,r}return a(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(K))(Y),z=j,$=new L((function(e){return e.complete()}));function q(e,t){return new L((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}var J=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function X(e){return v(null==e?void 0:e.then)}var Q="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Z(e,t,n,r){void 0===r&&(r=0);var i=t.schedule((function(){try{n.call(this)}catch(t){e.error(t)}}),r);return e.add(i),i}function ee(e,t){if(!e)throw new Error("Iterable cannot be null");return new L((function(n){var r=new w;return r.add(t.schedule((function(){var i=e[Symbol.asyncIterator]();r.add(t.schedule((function(){var e=this;i.next().then((function(t){t.done?n.complete():(n.next(t.value),e.schedule())}))})))}))),r}))}function te(e){return v(e[D])}function ne(e){return v(null==e?void 0:e[Q])}function re(e){return Symbol.asyncIterator&&v(null==e?void 0:e[Symbol.asyncIterator])}function ie(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function oe(e){return p(this,arguments,(function(){var t,n,r;return c(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,d(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,d(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,d(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function se(e){return v(null==e?void 0:e.getReader)}function ae(e,t){return t?function(e,t){if(null!=e){if(te(e))return function(e,t){return new L((function(n){var r=new w;return r.add(t.schedule((function(){var i=e[D]();r.add(i.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}))}(e,t);if(J(e))return q(e,t);if(X(e))return function(e,t){return new L((function(n){return t.schedule((function(){return e.then((function(e){n.add(t.schedule((function(){n.next(e),n.add(t.schedule((function(){return n.complete()})))})))}),(function(e){n.add(t.schedule((function(){return n.error(e)})))}))}))}))}(e,t);if(re(e))return ee(e,t);if(ne(e))return function(e,t){return new L((function(n){var r;return n.add(t.schedule((function(){r=e[Q](),Z(n,t,(function(){var e=r.next(),t=e.value;e.done?n.complete():(n.next(t),this.schedule())}))}))),function(){return v(null==r?void 0:r.return)&&r.return()}}))}(e,t);if(se(e))return function(e,t){return ee(oe(e),t)}(e,t)}throw ie(e)}(e,t):ce(e)}function ce(e){if(e instanceof L)return e;if(null!=e){if(te(e))return r=e,new L((function(e){var t=r[D]();if(v(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(J(e))return ue(e);if(X(e))return n=e,new L((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,R)}));if(re(e))return le(e);if(ne(e))return t=e,new L((function(e){var n,r;try{for(var i=u(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()}));if(se(e))return le(oe(e))}var t,n,r;throw ie(e)}function ue(e){return new L((function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()}))}function le(e){return new L((function(t){(function(e,t){var n,r,i,o;return function(e,t,n,r){return new(n||(n=Promise))((function(t,i){function o(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(o,s)}a((r=r.apply(e,[])).next())}))}(this,0,void 0,(function(){var s,a;return c(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=f(e),c.label=1;case 1:return[4,n.next()];case 2:if((r=c.sent()).done)return[3,4];if(s=r.value,t.next(s),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function he(e,t){return t?q(e,t):ue(e)}function de(e){return e&&v(e.schedule)}function pe(e){return e[e.length-1]}function fe(e){return v(pe(e))?e.pop():void 0}function ve(e){return de(pe(e))?e.pop():void 0}function Ee(e,t){return"number"==typeof pe(e)?e.pop():t}function ge(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ve(e);return n?q(e,n):he(e)}function be(e,t){var n=v(e)?e:function(){return e},r=function(e){return e.error(n())};return new L(t?function(e){return t.schedule(r,0,e)}:r)}var we=E((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}));function ye(e,t){var n="object"==typeof t;return new Promise((function(r,i){var o=new T({next:function(e){r(e),o.unsubscribe()},error:i,complete:function(){n?r(t.defaultValue):i(new we)}});e.subscribe(o)}))}function me(e){return e instanceof Date&&!isNaN(e)}var _e=E((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));function Re(e,t){var n=me(e)?{first:e}:"number"==typeof e?{each:e}:e,r=n.first,i=n.each,o=n.with,s=void 0===o?Ne:o,a=n.scheduler,c=void 0===a?null!=t?t:j:a,u=n.meta,l=void 0===u?null:u;if(null==r&&null==i)throw new TypeError("No timeout provided.");return k((function(e,t){var n,o,a=null,u=0,h=function(e){o=Z(t,c,(function(){n.unsubscribe(),ce(s({meta:l,lastValue:a,seen:u})).subscribe(t)}),e)};n=e.subscribe(new H(t,(function(e){null==o||o.unsubscribe(),u++,t.next(a=e),i>0&&h(i)}),void 0,void 0,(function(){(null==o?void 0:o.closed)||null==o||o.unsubscribe(),a=null}))),h(null!=r?"number"==typeof r?r:+r-c.now():i)}))}function Ne(e){throw new _e(e)}function Oe(e,t){return k((function(n,r){var i=0;n.subscribe(new H(r,(function(n){r.next(e.call(t,n,i++))})))}))}function Te(e,t,n){return void 0===n&&(n=1/0),v(t)?Te((function(n,r){return Oe((function(e,i){return t(n,e,r,i)}))(ce(e(n,r)))}),n):("number"==typeof t&&(n=t),k((function(t,r){return function(e,t,n,r,i,o,s,a){var c=[],u=0,l=0,h=!1,d=function(){!h||c.length||u||t.complete()},p=function(e){u++;var i=!1;ce(n(e,l++)).subscribe(new H(t,(function(e){t.next(e)}),(function(){i=!0}),void 0,(function(){if(i)try{u--;for(var e=function(){var e=c.shift();p(e)};c.length&&u<r;)e();d()}catch(e){t.error(e)}})))};return e.subscribe(new H(t,(function(e){return u<r?p(e):c.push(e)}),(function(){h=!0,d()}))),function(){}}(t,r,e,n)})))}function Ie(e){return void 0===e&&(e=1/0),Te(S,e)}function Ae(){return Ie(1)}function Ce(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ae()(he(e,ve(e)))}function De(e){return new L((function(t){ce(e()).subscribe(t)}))}function Se(e,t,n){void 0===e&&(e=0),void 0===n&&(n=z);var r=-1;return null!=t&&(de(t)?n=t:r=t),new L((function(t){var i=me(e)?+e-n.now():e;i<0&&(i=0);var o=0;return n.schedule((function(){t.closed||(t.next(o++),0<=r?this.schedule(void 0,r):t.complete())}),i)}))}function Pe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ve(e),r=Ee(e,1/0),i=e;return i.length?1===i.length?ce(i[0]):Ie(r)(he(i,n)):$}var Le,Ue,ke,He,xe,Fe,Ge=new L(N),Me=Array.isArray;function Be(e){return 1===e.length&&Me(e[0])?e[0]:e}function We(e,t){return function(n,r){return!e.call(t,n,r)}}function Ve(e,t){return k((function(n,r){var i=0;n.subscribe(new H(r,(function(n){return e.call(t,n,i++)&&r.next(n)})))}))}function Ye(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===(e=Be(e)).length?ce(e[0]):new L(Ke(e))}function Ke(e){return function(t){for(var n=[],r=function(r){n.push(ce(e[r]).subscribe(new H(t,(function(e){if(n){for(var i=0;i<n.length;i++)i!==r&&n[i].unsubscribe();n=null}t.next(e)}))))},i=0;n&&!t.closed&&i<e.length;i++)r(i)}}function je(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=fe(e),r=Be(e);return r.length?new L((function(e){var t=r.map((function(){return[]})),i=r.map((function(){return!1}));e.add((function(){t=i=null}));for(var o=function(o){ce(r[o]).subscribe(new H(e,(function(r){if(t[o].push(r),t.every((function(e){return e.length}))){var s=t.map((function(e){return e.shift()}));e.next(n?n.apply(void 0,h([],l(s))):s),t.some((function(e,t){return!e.length&&i[t]}))&&e.complete()}}),(function(){i[o]=!0,!t[o].length&&e.complete()})))},s=0;!e.closed&&s<r.length;s++)o(s);return function(){t=i=null}})):$}function ze(e){return k((function(t,n){var r,i=null,o=!1;i=t.subscribe(new H(n,void 0,void 0,(function(s){r=ce(e(s,ze(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):o=!0}))),o&&(i.unsubscribe(),i=null,r.subscribe(n))}))}function $e(e,t){return v(t)?Te(e,t,1):Te(e,1)}function qe(e){return k((function(t,n){var r=!1;t.subscribe(new H(n,(function(e){r=!0,n.next(e)}),(function(){r||n.next(e),n.complete()})))}))}function Je(e){return e<=0?function(){return $}:k((function(t,n){var r=0;t.subscribe(new H(n,(function(t){++r<=e&&(n.next(t),e<=r&&n.complete())})))}))}function Xe(e){return void 0===e&&(e=Qe),k((function(t,n){var r=!1;t.subscribe(new H(n,(function(e){r=!0,n.next(e)}),(function(){return r?n.complete():n.error(e())})))}))}function Qe(){return new we}function Ze(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Ve((function(t,n){return e(t,n,r)})):S,Je(1),n?qe(t):Xe((function(){return new we})))}}function et(e){return e<=0?function(){return $}:k((function(t,n){var r=[];t.subscribe(new H(n,(function(t){r.push(t),e<r.length&&r.shift()}),(function(){var e,t;try{for(var i=u(r),o=i.next();!o.done;o=i.next()){var s=o.value;n.next(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}n.complete()}),void 0,(function(){r=null})))}))}function tt(e){return k((function(t,n){var r,i,o=!1,s=function(){r=t.subscribe(new H(n,void 0,void 0,(function(t){i||(i=new F,e(i).subscribe(new H(n,(function(){return r?s():o=!0})))),i&&i.next(t)}))),o&&(r.unsubscribe(),r=null,o=!1,s())};s()}))}function nt(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new F}:t,r=e.resetOnError,i=void 0===r||r,o=e.resetOnComplete,s=void 0===o||o,a=e.resetOnRefCountZero,c=void 0===a||a;return function(e){var t=null,r=null,o=null,a=0,u=!1,l=!1,h=function(){null==r||r.unsubscribe(),r=null},d=function(){h(),t=o=null,u=l=!1},p=function(){var e=t;d(),null==e||e.unsubscribe()};return k((function(e,f){a++,l||u||h();var v=o=null!=o?o:n();f.add((function(){0!=--a||l||u||(r=rt(p,c))})),v.subscribe(f),t||(t=new T({next:function(e){return v.next(e)},error:function(e){l=!0,h(),r=rt(d,i,e),v.error(e)},complete:function(){u=!0,h(),r=rt(d,s),v.complete()}}),ae(e).subscribe(t))}))(e)}}function rt(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return!0===t?(e(),null):!1===t?null:t.apply(void 0,h([],l(n))).pipe(Je(1)).subscribe((function(){return e()}))}function it(e,t,n){var r,i,o,s=!1;return e&&"object"==typeof e?(o=null!==(r=e.bufferSize)&&void 0!==r?r:1/0,t=null!==(i=e.windowTime)&&void 0!==i?i:1/0,s=!!e.refCount,n=e.scheduler):o=null!=e?e:1/0,nt({connector:function(){return new W(o,t,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:s})}function ot(){return function(e,t){return k((function(n,r){var i=null,o=0,s=!1,a=function(){return s&&!i&&r.complete()};n.subscribe(new H(r,(function(n){null==i||i.unsubscribe();var s=0,c=o++;ce(e(n,c)).subscribe(i=new H(r,(function(e){return r.next(t?t(n,e,c,s++):e)}),(function(){i=null,a()})))}),(function(){s=!0,a()})))}))}(S)}function st(e){return k((function(t,n){ce(e).subscribe(new H(n,(function(){return n.complete()}),N)),!n.closed&&t.subscribe(n)}))}function at(e,t,n){var r=v(e)||t||n?{next:e,error:t,complete:n}:e;return r?k((function(e,t){e.subscribe(new H(t,(function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)}),(function(){var e;null===(e=r.complete)||void 0===e||e.call(r),t.complete()}),(function(e){var n;null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)})))})):S}class ct extends Error{constructor(e,t){super(e),this.type=t,this.type=t,Object.setPrototypeOf(this,new.target.prototype)}}function ut(e,t,n=Le.ERROR,r=Ue.JS_LIB){t?null==t||t.write({level:n,layer:r,message:e}):t||n!==Le.ERROR||console.error(e)}function lt(e){return void 0!==e}!function(e){e.ERROR="error",e.WARNING="warning",e.INFO="info"}(Le||(Le={})),function(e){e.CHROME_EXTENSION="chrome-extension",e.NATIVE_CONSOLE="native-console",e.JS_LIB="js-lib"}(Ue||(Ue={})),function(e){e.SDK_USAGE_ERROR="sdk-usage-error",e.FEATURE_NOT_SUPPORTED="feature-not-supported",e.DEVICE_ERROR="device-error",e.UNEXPECTED_ERROR="unexpected-error",e.INIT_ERROR="init-error"}(ke||(ke={}));class ht{constructor(e,t){this.compare=t,this.remove=new F,this.itemRemoved=this.remove,this.items=new M([]),this.itemList=this.items,this.itemAdded=e.pipe(Oe((e=>(this.addItem(e),e))),nt()),this.itemAdded.subscribe({next:e=>{e.onDisconnect.pipe(Ze(),Oe((()=>this.removeItem(e.id))),Ve(lt)).subscribe((e=>this.remove.next(e)))},error:N}),this.itemRemoved.subscribe({error:N})}getValue(){return[...this.items.getValue()]}addItem(e){if(this.items.getValue().filter((t=>t.id.equals(e.id))).length>0)throw new ct("This item has already been added.",ke.UNEXPECTED_ERROR);const t=this.items.getValue().concat([e]);t.sort(this.compare),this.items.next(t)}removeItem(e){const t=this.getValue(),n=t.findIndex((t=>t.id.equals(e)));if(-1===n)throw new ct("Item not found and therefore cannot be removed.",ke.UNEXPECTED_ERROR);const r=t.splice(n,1)[0];return this.items.next(t),r}}class dt{constructor(e,t){this.sdkVersion="4.1.1",this.consoleAppVersion=e.pipe(Ze((e=>"ready"===e.event)),Oe((e=>e.version)),Re(1e3),it(1),ze((()=>ge(null)))),this.chromeExtensionVersion=e.pipe(Ze((e=>"chrome-extension-ready"===e.event)),Oe((e=>e.version)),Re(1e3),it(1),ze((()=>ge(null)))),je(this.consoleAppVersion,this.chromeExtensionVersion).subscribe((e=>{const n=`sdkVersion: ${this.sdkVersion} | chromeHostVersion: ${e[0]}`;let r;r="undefined"!=typeof process?`${n} | nodeVersion: ${process.version} | platform: ${process.platform}`:`${n} | chromeExtensionVersion: ${e[1]} | browserUserAgent: ${window.navigator.userAgent}`,ut(r,t,Le.INFO)}))}}class pt{constructor(e,t,n){this.deviceDetector=e,this.deviceAdded=this.deviceDetector.deviceObservables.itemAdded,this.deviceRemoved=this.deviceDetector.deviceObservables.itemRemoved,this.deviceList=this.deviceDetector.deviceObservables.itemList,He.set(this,void 0),this._transport=t,this._readyEvents=t.consoleAppEvent.pipe(Ve((e=>"ready"===e.event||"chrome-extension-ready"===e.event)),it(2)),this._readyEvents.subscribe(),this._config=n,this.transportContext=t.context,o(this,He,new dt(this._readyEvents,null==n?void 0:n.logger),"f")}getVersion(){return i(this,He,"f").sdkVersion}getChromehostVersion(){return ye(i(this,He,"f").consoleAppVersion)}getChromeExtensionVersion(){return ye(i(this,He,"f").chromeExtensionVersion)}}He=new WeakMap,function(e){e.NODE="node",e.CHROME_EXTENSION="chrome-extension",e.WEB_HID="web-hid"}(xe||(xe={})),function(e){e.CHROME_EXTENSION="chrome-extension",e.WEB_HID="web-hid",e.CHROME_EXTENSION_WITH_WEB_HID_FALLBACK="chrome-extension-with-web-hid-fallback"}(Fe||(Fe={}));const ft="Failed to dynamically import file. Please contact a Jabra representative as we would love to learn about scenarios where this could happen!";function vt(e,t=Fe.CHROME_EXTENSION,i){return r(this,void 0,void 0,(function*(){if(t!==Fe.WEB_HID){const r=yield Promise.resolve().then(n.bind(n,85)).catch((()=>{throw new ct(ft,ke.UNEXPECTED_ERROR)})),o=yield r.TransportChromeExtension.checkInstallation();if(o.ok)return ut("Using Chrome extension for transport.",e,Le.INFO),new r.TransportChromeExtension(e,i);if(t===Fe.CHROME_EXTENSION)throw new ct(o.message,ke.INIT_ERROR);t===Fe.CHROME_EXTENSION_WITH_WEB_HID_FALLBACK&&ut(o.message,e,Le.INFO)}return ut("Using WebHID for transport.",e,Le.INFO),function(e,t){return r(this,void 0,void 0,(function*(){const r=yield Promise.resolve().then(n.bind(n,290)).catch((()=>{throw new ct(ft,ke.UNEXPECTED_ERROR)})),i=yield Promise.resolve().then(n.bind(n,685)).catch((()=>{throw new ct(ft,ke.UNEXPECTED_ERROR)})),o=r.initHandler(e);return new i.WebHidTransport(o,e,t)}))}(e,i)}))}class Et{constructor(e,t){this.log=e.consoleAppEvent.pipe(Ve((e=>"log"===e.event)),Oe((e=>({message:e.message,level:e.level,layer:e.layer})))),this.log.subscribe((e=>ut(e.message,t,e.level,e.layer)))}}const gt=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];class bt{constructor(e){this.config=e,this.messageShown=!1}validateOrganizationKey(){var e;(null===(e=this.config)||void 0===e?void 0:e.partnerKey)?this.validateCrc(this.config.partnerKey)||this.logWarning("Invalid partner key."):this.logWarning("No partner key provided.")}validateAppId(){var e;(null===(e=this.config)||void 0===e?void 0:e.appId)?this.config.appId.length<3?this.logWarning("The appId should be minimum 3 characters.",!1):this.config.appId.length>100?this.logWarning("The appId should be no longer than 100 characters.",!1):/^[A-Za-z0-9\-_]+$/.test(this.config.appId)||this.logWarning("The appId is invalid. Should consist of letters, numbers, underscores or dashes",!1):this.logWarning("No app identifier provided.")}validateAppName(){var e;(null===(e=this.config)||void 0===e?void 0:e.appName)?/^[\x20-\x7F]*$/.test(this.config.appName)?this.config.appName.length>100?this.logWarning("The app name should be no longer than 100 characters.",!1):/^[A-Za-z0-9]+[A-Za-z0-9 &-]*$/g.test(this.config.appName)||this.logWarning("The appName is invalid. Name should consist of letters, numbers, spaces, ampersands and dashes. Name should not begin with spaces, ampersands or dashes.",!1):this.logWarning("The app name can only contain ASCII characters",!1):this.logWarning("No app name provided. Will fallback to use appId as name.",!1)}logWarning(e,t=!0){this.messageShown||(this.messageShown=!0,t?console.warn(`\n        ${e}\n        \n        Add keys to the config object on initialization.\n        E.g. await init({\n          partnerKey: 'my-partner-key-from-developer-zone',\n          appId: 'my-self-chosen-app-id',\n          appName: 'My App Name'\n        });\n\n        Please obtain a valid partner key from https://developer.jabra.com.\n        The key will ensure interoperability with other Jabra apps and services, and mitigate\n        some co-existence issues with other softphone applications.\n\n        The package will continue to work without the keys, but we do not recommend production release\n        without it. Read more on the Developer Zone.\n      \n      `):console.warn(e))}validateCrc(e){const[t,...n]=e.split("-"),r=function(e){let t,n,r=65535;for(n=0;n<e.length;n+=1){const i=e.charCodeAt(n);if(i>255)throw new RangeError;t=255&(i^r>>8),r=gt[t]^r<<8}return 65535&(0^r)}(n.join("-")).toString(16).padStart(4,"0");return t===r}}var wt,yt,mt,_t,Rt,Nt,Ot;!function(e){e[e.MS_OC=0]="MS_OC",e[e.CISCO=1]="CISCO",e[e.AVAYA=2]="AVAYA",e[e.SIEMENS=3]="SIEMENS",e[e.ALCATEL=4]="ALCATEL",e[e.IBM=5]="IBM",e[e.AASTRA=6]="AASTRA",e[e.SKYPE=7]="SKYPE",e[e.GENERIC=8]="GENERIC",e[e.NORTEL=9]="NORTEL",e[e.JABRA=10]="JABRA",e[e.NEC=11]="NEC",e[e.SHORETEL=12]="SHORETEL",e[e.OTHER=255]="OTHER"}(wt||(wt={}));class Tt{constructor(e,t){this.gnpReadCommand=e,this.serialize=t,this.command=e.command,this.subCommand=e.subCommand}deserialize(e){return this.gnpReadCommand.deserialize(e)}}!function(e){e[e.GN_PROTOCOL=65280]="GN_PROTOCOL"}(yt||(yt={})),function(e){e[e.DATA=1]="DATA"}(mt||(mt={}));class It{constructor(e,t,n,r,i,o=new Uint8Array,s=0){this.destination=e,this.source=t,this.type=n,this.command=r,this.subCommand=i,this.payload=o,this.sequenceNumber=s}}!function(e){e[e.PC_ADDR=0]="PC_ADDR",e[e.BASE_ADDR=1]="BASE_ADDR",e[e.HS1_ADDR=4]="HS1_ADDR",e[e.HS_BT_USB_ADDR=8]="HS_BT_USB_ADDR",e[e.HS_CRADLE_ADDR=10]="HS_CRADLE_ADDR",e[e.CRADLE_ADDR=21]="CRADLE_ADDR"}(_t||(_t={})),function(e){e[e.EVENT=0]="EVENT",e[e.READ=1]="READ",e[e.WRITE=2]="WRITE",e[e.REPLY=3]="REPLY"}(Rt||(Rt={})),function(e){e[e.IDENT=2]="IDENT",e[e.DFU=7]="DFU",e[e.DEVICE=13]="DEVICE",e[e.FWU=15]="FWU",e[e.STATUS=18]="STATUS",e[e.CONFIG=19]="CONFIG",e[e.NACK=254]="NACK",e[e.ACK=255]="ACK"}(Nt||(Nt={})),function(e){e[e.CONFIG_PREFERRED_SOFTPHONE=34]="CONFIG_PREFERRED_SOFTPHONE",e[e.ID=1]="ID",e[e.IDENT_GET_AVAILABLE_SOFTPHONES=16]="IDENT_GET_AVAILABLE_SOFTPHONES",e[e.TYPE=2]="TYPE",e[e.NAME=0]="NAME",e[e.PID=17]="PID",e[e.ATTACH_EVENT=1]="ATTACH_EVENT",e[e.DETACH_EVENT=2]="DETACH_EVENT"}(Ot||(Ot={}));const At={command:Nt.DEVICE,subCommand:Ot.ATTACH_EVENT,serialize:e=>Uint8Array.from([5,0])};function Ct(e){const t=e.payload,n=t[0],r=t.length-1;if(r!==n)throw new ct(`Invalid response. Expected length: ${n}, actual: ${r}`,ke.DEVICE_ERROR);const i=t.slice(1);return String.fromCharCode(...Array.from(i))}class Dt{constructor(){this.command=Nt.IDENT,this.subCommand=Ot.IDENT_GET_AVAILABLE_SOFTPHONES,this.deserialize=e=>{const t=e.payload,n=t[0],r=t.length-1;if(r!==n)throw new ct(`Invalid response. Expected length: ${n}, actual: ${r}`,ke.DEVICE_ERROR);const i=[];return t.slice(1).forEach((e=>{i.push(e)})),i}}}const St={command:Nt.IDENT,subCommand:Ot.NAME,deserialize:Ct},Pt={command:Nt.IDENT,subCommand:Ot.PID,deserialize:function(e){const t=e instanceof It?e.payload:e;return new DataView(t.buffer).getUint16(0,!0)}};class Lt{constructor(){this.command=Nt.CONFIG,this.subCommand=Ot.CONFIG_PREFERRED_SOFTPHONE,this.deserialize=e=>e.payload[0],this.serialize=e=>Uint8Array.of(e)}}class Ut{constructor(){this.command=Nt.IDENT,this.subCommand=Ot.TYPE,this.deserialize=e=>e.source}}const kt={command:Nt.IDENT,subCommand:Ot.ID,deserialize:Ct};function Ht(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var xt,Ft,Gt=Ht((function(e){e.exports=function(){var e=function(e,t,n,r,i,o){for(var s=function(e,t){var n=e.toString(16);return n.length<2&&(n="0"+n),t&&(n=n.toUpperCase()),n},a=t;a<=n;a++)i[o++]=s(e[a],r);return i},t=function(e,t,n,r,i){for(var o=t;o<=n;o+=2)r[i++]=parseInt(e.substr(o,2),16)},n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.-:+=^!/*?&<>()[]{}@%$#".split(""),r=[0,68,0,84,83,82,72,0,75,76,70,65,0,63,62,69,0,1,2,3,4,5,6,7,8,9,64,0,73,66,74,71,81,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,77,0,78,67,0,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,79,0,80,0,0],i=function(e,t){if(t%4!=0)throw new Error("z85_encode: invalid input length (multiple of 4 expected)");for(var r="",i=0,o=0;i<t;)if(o=256*o+e[i++],i%4==0){for(var s=52200625;s>=1;){var a=Math.floor(o/s)%85;r+=n[a],s/=85}o=0}return r},o=function(e,t){var n=e.length;if(n%5!=0)throw new Error("z85_decode: invalid input length (multiple of 5 expected)");void 0===t&&(t=new Array(4*n/5));for(var i=0,o=0,s=0;i<n;){var a=e.charCodeAt(i++)-32;if(a<0||a>=r.length)break;if(s=85*s+r[a],i%5==0){for(var c=16777216;c>=1;)t[o++]=Math.trunc(s/c%256),c/=256;s=0}}return t},s=function(e,t){var n={ibits:8,obits:8,obigendian:!0};for(var r in t)void 0!==n[r]&&(n[r]=t[r]);for(var i,o,s,a=[],c=0,u=0,l=0,h=e.length;0===u&&(o=e.charCodeAt(c++)),i=o>>n.ibits-(u+8)&255,u=(u+8)%n.ibits,n.obigendian?0===l?s=i<<n.obits-8:s|=i<<n.obits-8-l:0===l?s=i:s|=i<<l,!(0==(l=(l+8)%n.obits)&&(a.push(s),c>=h)););return a},a=function(e,t){var n={ibits:32,ibigendian:!0};for(var r in t)void 0!==n[r]&&(n[r]=t[r]);var i="",o=4294967295;n.ibits<32&&(o=(1<<n.ibits)-1);for(var s=e.length,a=0;a<s;a++)for(var c=e[a]&o,u=0;u<n.ibits;u+=8)n.ibigendian?i+=String.fromCharCode(c>>n.ibits-8-u&255):i+=String.fromCharCode(c>>u&255);return i},c=256,u=function(e,t,n,r,i,o,s,a){return[a,s,o,i,r,n,t,e]},l=function(){return u(0,0,0,0,0,0,0,0)},h=function(e){return e.slice(0)},d=function(e){for(var t=l(),n=0;n<8;n++)t[n]=Math.floor(e%c),e/=c;return t},p=function(e){for(var t=0,n=7;n>=0;n--)t*=c,t+=e[n];return Math.floor(t)},f=function(e,t){for(var n=0,r=0;r<8;r++)n+=e[r]+t[r],e[r]=Math.floor(n%c),n=Math.floor(n/c);return n},v=function(e,t){for(var n=0,r=0;r<8;r++)n+=e[r]*t,e[r]=Math.floor(n%c),n=Math.floor(n/c);return n},E=function(e,t){for(var n=0;n<8;n++)e[n]&=t[n];return e},g=function(e,t){var n=l();if(t%8!=0)throw new Error("ui64_rorn: only bit rotations supported with a multiple of digit bits");for(var r=Math.floor(t/8),i=0;i<r;i++){for(var o=6;o>=0;o--)n[o+1]=n[o];for(n[0]=e[0],o=0;o<7;o++)e[o]=e[o+1];e[o]=0}return p(n)},b=function(e,t){if(t>64)throw new Error("ui64_ror: invalid number of bits to shift");var n,r=new Array(16);for(n=0;n<8;n++)r[n+8]=e[n],r[n]=0;var i=Math.floor(t/8),o=t%8;for(n=i;n<15;n++)r[n-i]=255&(r[n]>>>o|r[n+1]<<8-o);for(r[15-i]=r[15]>>>o&255,n=15-i+1;n<16;n++)r[n]=0;for(n=0;n<8;n++)e[n]=r[n+8];return r.slice(0,8)},w=function(e,t){for(var n=0;n<8;n++)e[n]^=t[n]},y=function(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n},m=function(e,t){return e<<t&4294967295|e>>>32-t&4294967295},_=function(e){return a(function(e,t){function n(e,t,n,r){return e<20?t&n|~t&r:e<40?t^n^r:e<60?t&n|t&r|n&r:t^n^r}function r(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var i=Array(80),o=1732584193,s=-271733879,a=-1732584194,c=271733878,u=-1009589776,l=0;l<e.length;l+=16){for(var h=o,d=s,p=a,f=c,v=u,E=0;E<80;E++){i[E]=E<16?e[l+E]:m(i[E-3]^i[E-8]^i[E-14]^i[E-16],1);var g=y(y(m(o,5),n(E,s,a,c)),y(y(u,i[E]),r(E)));u=c,c=a,a=m(s,30),s=o,o=g}o=y(o,h),s=y(s,d),a=y(a,p),c=y(c,f),u=y(u,v)}return[o,s,a,c,u]}(s(e,{ibits:8,obits:32,obigendian:!0}),8*e.length),{ibits:32,ibigendian:!0})},R=function(e){return a(function(e,t){function n(e,t,n,r,i,o){return y(m(y(y(t,e),y(r,o)),i),n)}function r(e,t,r,i,o,s,a){return n(t&r|~t&i,e,t,o,s,a)}function i(e,t,r,i,o,s,a){return n(t&i|r&~i,e,t,o,s,a)}function o(e,t,r,i,o,s,a){return n(t^r^i,e,t,o,s,a)}function s(e,t,r,i,o,s,a){return n(r^(t|~i),e,t,o,s,a)}e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var a=1732584193,c=-271733879,u=-1732584194,l=271733878,h=0;h<e.length;h+=16){var d=a,p=c,f=u,v=l;a=r(a,c,u,l,e[h+0],7,-680876936),l=r(l,a,c,u,e[h+1],12,-389564586),u=r(u,l,a,c,e[h+2],17,606105819),c=r(c,u,l,a,e[h+3],22,-1044525330),a=r(a,c,u,l,e[h+4],7,-176418897),l=r(l,a,c,u,e[h+5],12,1200080426),u=r(u,l,a,c,e[h+6],17,-1473231341),c=r(c,u,l,a,e[h+7],22,-45705983),a=r(a,c,u,l,e[h+8],7,1770035416),l=r(l,a,c,u,e[h+9],12,-1958414417),u=r(u,l,a,c,e[h+10],17,-42063),c=r(c,u,l,a,e[h+11],22,-1990404162),a=r(a,c,u,l,e[h+12],7,1804603682),l=r(l,a,c,u,e[h+13],12,-40341101),u=r(u,l,a,c,e[h+14],17,-1502002290),a=i(a,c=r(c,u,l,a,e[h+15],22,1236535329),u,l,e[h+1],5,-165796510),l=i(l,a,c,u,e[h+6],9,-1069501632),u=i(u,l,a,c,e[h+11],14,643717713),c=i(c,u,l,a,e[h+0],20,-373897302),a=i(a,c,u,l,e[h+5],5,-701558691),l=i(l,a,c,u,e[h+10],9,38016083),u=i(u,l,a,c,e[h+15],14,-660478335),c=i(c,u,l,a,e[h+4],20,-405537848),a=i(a,c,u,l,e[h+9],5,568446438),l=i(l,a,c,u,e[h+14],9,-1019803690),u=i(u,l,a,c,e[h+3],14,-187363961),c=i(c,u,l,a,e[h+8],20,1163531501),a=i(a,c,u,l,e[h+13],5,-1444681467),l=i(l,a,c,u,e[h+2],9,-51403784),u=i(u,l,a,c,e[h+7],14,1735328473),a=o(a,c=i(c,u,l,a,e[h+12],20,-1926607734),u,l,e[h+5],4,-378558),l=o(l,a,c,u,e[h+8],11,-2022574463),u=o(u,l,a,c,e[h+11],16,1839030562),c=o(c,u,l,a,e[h+14],23,-35309556),a=o(a,c,u,l,e[h+1],4,-1530992060),l=o(l,a,c,u,e[h+4],11,1272893353),u=o(u,l,a,c,e[h+7],16,-155497632),c=o(c,u,l,a,e[h+10],23,-1094730640),a=o(a,c,u,l,e[h+13],4,681279174),l=o(l,a,c,u,e[h+0],11,-358537222),u=o(u,l,a,c,e[h+3],16,-722521979),c=o(c,u,l,a,e[h+6],23,76029189),a=o(a,c,u,l,e[h+9],4,-640364487),l=o(l,a,c,u,e[h+12],11,-421815835),u=o(u,l,a,c,e[h+15],16,530742520),a=s(a,c=o(c,u,l,a,e[h+2],23,-995338651),u,l,e[h+0],6,-198630844),l=s(l,a,c,u,e[h+7],10,1126891415),u=s(u,l,a,c,e[h+14],15,-1416354905),c=s(c,u,l,a,e[h+5],21,-57434055),a=s(a,c,u,l,e[h+12],6,1700485571),l=s(l,a,c,u,e[h+3],10,-1894986606),u=s(u,l,a,c,e[h+10],15,-1051523),c=s(c,u,l,a,e[h+1],21,-2054922799),a=s(a,c,u,l,e[h+8],6,1873313359),l=s(l,a,c,u,e[h+15],10,-30611744),u=s(u,l,a,c,e[h+6],15,-1560198380),c=s(c,u,l,a,e[h+13],21,1309151649),a=s(a,c,u,l,e[h+4],6,-145523070),l=s(l,a,c,u,e[h+11],10,-1120210379),u=s(u,l,a,c,e[h+2],15,718787259),c=s(c,u,l,a,e[h+9],21,-343485551),a=y(a,d),c=y(c,p),u=y(u,f),l=y(l,v)}return[a,c,u,l]}(s(e,{ibits:8,obits:32,obigendian:!1}),8*e.length),{ibits:32,ibigendian:!1})},N=function(e){this.mul=u(88,81,244,45,76,149,127,45),this.inc=u(20,5,123,126,247,103,129,79),this.mask=u(0,0,0,0,255,255,255,255),this.state=h(this.inc),this.next(),E(this.state,this.mask),e=d(void 0!==e?e>>>0:4294967295*Math.random()>>>0),function(e,t){for(var n=0;n<8;n++)e[n]|=t[n]}(this.state,e),this.next()};N.prototype.next=function(){var e=h(this.state);(function(e,t){var n,r,i,o=new Array(16);for(n=0;n<16;n++)o[n]=0;for(n=0;n<8;n++){for(i=0,r=0;r<8;r++)i+=e[n]*t[r]+o[n+r],o[n+r]=i%c,i/=c;for(;r<16-n;r++)i+=o[n+r],o[n+r]=i%c,i/=c}for(n=0;n<8;n++)e[n]=o[n];o.slice(8,8)})(this.state,this.mul),f(this.state,this.inc);var t=h(e);b(t,18),w(t,e),b(t,27);var n=h(e);b(n,59),E(t,this.mask);var r=p(n),i=h(t);return function(e,t){if(t>64)throw new Error("ui64_rol: invalid number of bits to shift");var n,r=new Array(16);for(n=0;n<8;n++)r[n+8]=0,r[n]=e[n];var i=Math.floor(t/8),o=t%8;for(n=7-i;n>0;n--)r[n+i]=255&(r[n]<<o|r[n-1]>>>8-o);for(r[0+i]=r[0]<<o&255,n=0+i-1;n>=0;n--)r[n]=0;for(n=0;n<8;n++)e[n]=r[n];r.slice(8,8)}(i,32-r),b(t,r),w(t,i),p(t)};var O=new N,T=function(e,t){for(var n=[],r=0;r<e;r++)n[r]=O.next()%t;return n},I=0,A=0,C=function(){if(1===arguments.length&&"string"==typeof arguments[0])this.parse.apply(this,arguments);else if(arguments.length>=1&&"number"==typeof arguments[0])this.make.apply(this,arguments);else{if(arguments.length>=1)throw new Error("UUID: constructor: invalid arguments");for(var e=0;e<16;e++)this[e]=0}};return(C.prototype="undefined"!=typeof Uint8Array?new Uint8Array(16):Buffer?Buffer.alloc(16):new Array(16)).constructor=C,C.prototype.make=function(e){var t,n=this;if(1===e){var r=(new Date).getTime();r!==I?A=0:A++,I=r;var i,o=d(r);v(o,1e4),f(o,u(1,178,29,210,19,129,64,0)),A>0&&f(o,d(A)),i=g(o,8),n[3]=255&i,i=g(o,8),n[2]=255&i,i=g(o,8),n[1]=255&i,i=g(o,8),n[0]=255&i,i=g(o,8),n[5]=255&i,i=g(o,8),n[4]=255&i,i=g(o,8),n[7]=255&i,i=g(o,8),n[6]=15&i;var s=T(2,255);n[8]=s[0],n[9]=s[1];var a=T(6,255);for(a[0]|=1,a[0]|=2,t=0;t<6;t++)n[10+t]=a[t]}else if(4===e){var c=T(16,255);for(t=0;t<16;t++)this[t]=c[t]}else{if(3!==e&&5!==e)throw new Error("UUID: make: invalid version");var l="",h="object"==typeof arguments[1]&&arguments[1]instanceof C?arguments[1]:(new C).parse(arguments[1]);for(t=0;t<16;t++)l+=String.fromCharCode(h[t]);l+=arguments[2];var p=3===e?R(l):_(l);for(t=0;t<16;t++)n[t]=p.charCodeAt(t)}return n[6]&=15,n[6]|=e<<4,n[8]&=63,n[8]|=128,n},C.prototype.format=function(t){var n,r;return"z85"===t?n=i(this,16):"b16"===t?(r=Array(32),e(this,0,15,!0,r,0),n=r.join("")):void 0!==t&&"std"!==t||(r=new Array(36),e(this,0,3,!1,r,0),r[8]="-",e(this,4,5,!1,r,9),r[13]="-",e(this,6,7,!1,r,14),r[18]="-",e(this,8,9,!1,r,19),r[23]="-",e(this,10,15,!1,r,24),n=r.join("")),n},C.prototype.toString=function(e){return this.format(e)},C.prototype.toJSON=function(){return this.format("std")},C.prototype.parse=function(e,n){if("string"!=typeof e)throw new Error("UUID: parse: invalid argument (type string expected)");if("z85"===n)o(e,this);else if("b16"===n)t(e,0,35,this,0);else if(void 0===n||"std"===n){var r={nil:"00000000-0000-0000-0000-000000000000","ns:DNS":"6ba7b810-9dad-11d1-80b4-00c04fd430c8","ns:URL":"6ba7b811-9dad-11d1-80b4-00c04fd430c8","ns:OID":"6ba7b812-9dad-11d1-80b4-00c04fd430c8","ns:X500":"6ba7b814-9dad-11d1-80b4-00c04fd430c8"};if(void 0!==r[e])e=r[e];else if(!e.match(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/))throw new Error('UUID: parse: invalid string representation (expected "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx")');t(e,0,7,this,0),t(e,9,12,this,4),t(e,14,17,this,6),t(e,19,22,this,8),t(e,24,35,this,10)}return this},C.prototype.export=function(){for(var e=Array(16),t=0;t<16;t++)e[t]=this[t];return e},C.prototype.import=function(e){if(!("object"==typeof e&&e instanceof Array))throw new Error("UUID: import: invalid argument (type Array expected)");if(16!==e.length)throw new Error("UUID: import: invalid argument (Array of length 16 expected)");for(var t=0;t<16;t++){if("number"!=typeof e[t])throw new Error("UUID: import: invalid array element #"+t+" (type Number expected)");if(!isFinite(e[t])||Math.floor(e[t])!==e[t])throw new Error("UUID: import: invalid array element #"+t+" (Number with integer value expected)");if(!(e[t]>=0&&e[t]<=255))throw new Error("UUID: import: invalid array element #"+t+" (Number with integer value in range 0...255 expected)");this[t]=e[t]}return this},C.prototype.compare=function(e){if("object"!=typeof e)throw new Error("UUID: compare: invalid argument (type UUID expected)");if(!(e instanceof C))throw new Error("UUID: compare: invalid argument (type UUID expected)");for(var t=0;t<16;t++){if(this[t]<e[t])return-1;if(this[t]>e[t])return 1}return 0},C.prototype.equal=function(e){return 0===this.compare(e)},C.prototype.fold=function(e){if(void 0===e)throw new Error("UUID: fold: invalid argument (number of fold operations expected)");if(e<1||e>4)throw new Error("UUID: fold: invalid argument (1-4 fold operations expected)");for(var t=16/Math.pow(2,e),n=new Array(t),r=0;r<t;r++){for(var i=0,o=0;r+o<16;o+=t)i^=this[r+o];n[r]=i}return n},C.PCG=N,C}(),e.exports.default=e.exports}));class Mt{constructor(e){this.transport=e,this.gnpLockAcquired=e.consoleAppEvent.pipe(Ve((e=>"response-gnp-lock"===e.event)),Oe((e=>e.token)),it(1)),this.gnpLockAcquired.subscribe()}acquireGnpLock(e){const t=new Gt(4).toString(),n={action:"request-gnp-lock",id:e,token:t},r=this.gnpLockAcquired.pipe(Ze((e=>e===t)));return this.transport.writeAction(n),r}releaseGnpLock(e,t){const n={action:"release-gnp-lock",id:e,token:t};this.transport.writeAction(n)}}!function(e){e[e.INPUT=0]="INPUT",e[e.OUTPUT=1]="OUTPUT",e[e.FEATURE=2]="FEATURE"}(xt||(xt={})),function(e){e.ABSOLUTE="absolute",e.RELATIVE="relative"}(Ft||(Ft={}));class Bt{constructor(e){this.id=e}equals(e){return this.id===e.id}startsWith(e){return this.id.startsWith(e.id)}toString(){return this.id}}function Wt(e,t,n){const r=e.toString(16).padStart(4,"0"),i=t.toString(16).padStart(4,"0");return new Bt(`${r}:${i}:${n}`)}class Vt{constructor(e,t,n,r){this.id=e,this.usagePage=t,this.usage=n,this.value=r}isArray(){return Array.isArray(this.value)}static deserialize(e,t){return new Vt(new Bt(e),t.usagePage,t.usage,t.value)}}class Yt{constructor(e,t,n){this.descriptor=t,this.transport=n,this.transportId=e.transportId,this.input=n.consoleAppEvent.pipe(Ve((e=>e.id===this.transportId)),Yt.inputReportsFilter)}output(e,t,n){const r={action:"hid-output",id:this.transportId,usagePage:e,usage:t,value:n};this.transport.writeAction(r)}getFeatureReport(e,t){const n=new Gt(4).toString(),r={action:"request-hid-feature",id:this.transportId,token:n,usagePage:e,usage:t};return this.transport.writeAction(r),this.transport.consoleAppEvent.pipe(Ze((e=>"response-hid-feature"===e.event&&e.token===n)),Oe((e=>e.value)))}setFeatureReport(e,t,n){const r={action:"set-hid-feature",id:this.transportId,usagePage:e,usage:t,value:n};this.transport.writeAction(r)}findDescriptor(e,t,n){return this.descriptor.find((r=>r.usagePage===e&&r.usage===t&&r.reportType===n))}}Yt.inputReportsFilter=e=>e.pipe(Ve((e=>"hid-input"===e.event)),Oe((e=>Vt.deserialize(e.id,e))));class Kt{static typeFromAttr(e){return e>>6}static packetLengthFromAttr(e){return e&this.lengthMask}static deserialize(e){const t=e[0],n=e[1],r=e[2],i=this.typeFromAttr(e[3]),o=e[4],s=e[5],a=this.packetLengthFromAttr(e[3]),c=e.slice(6,a);return new It(t,n,i,o,s,c,r)}}Kt.lengthMask=63;class jt{constructor(){this.data=[]}hasHeader(){return this.data.length>=jt.gnpPacketHeaderLength}expectedPacketLength(){if(!this.hasHeader())throw new ct("Unable to get expected packet length without a full header",ke.UNEXPECTED_ERROR);return Kt.packetLengthFromAttr(this.data[3])}appendData(e){this.hasHeader()&&this.expectedPacketLength()>jt.gnpPacketMaxLength&&(this.data=[]),this.data=this.data.concat(e)}hasFullPacket(){if(!this.hasHeader())return!1;const e=this.expectedPacketLength();return this.data.length>=e}getPacketAndReset(){if(!this.hasFullPacket())throw new ct("Trying to get packet but buffer is not complete",ke.UNEXPECTED_ERROR);const e=Kt.deserialize(Uint8Array.from(this.data));return this.data=[],e}}jt.gnpPacketHeaderLength=6,jt.gnpPacketMaxLength=63;const zt=()=>{};function $t(e){return at((t=>e()),(t=>e()),(()=>zt))}const qt=()=>{return e=e=>e.command===Nt.NACK,t=e=>new ct(`Got NACK response. Reason: ${e.subCommand}`,ke.DEVICE_ERROR),n=>n.pipe(Oe((n=>e(n)?be(t(n)):ge(n))),ot());var e,t},Jt=e=>Ze((t=>t.type===Rt.REPLY&&t.sequenceNumber===e.sequenceNumber&&t.destination===e.source&&t.source===e.destination));class Xt{constructor(e,t,n,r,i=0){this.hidChannel=e,this.gnpLock=t,this.transportId=n,this.primaryAddress=r,this.lockQueue=[],this.packets=e.input.pipe(Xt.inputFilter),this.events=this.packets.pipe(Xt.eventsFilter),this.nextSequenceNumber=i}static get inputFilter(){return e=>{const t=e.pipe(Ve((e=>e.usagePage===yt.GN_PROTOCOL&&e.usage===mt.DATA&&e.isArray()))),n=new jt;return t.pipe(Te((e=>{const t=e.value;return n.appendData(t),n.hasFullPacket()?ge(n.getPacketAndReset()):Ge})),nt())}}static supportsGnpOverHid(e){return void 0!==e.findDescriptor(yt.GN_PROTOCOL,mt.DATA,xt.OUTPUT)}getNextSequenceNumber(){const e=this.nextSequenceNumber;return this.nextSequenceNumber=(this.nextSequenceNumber+1)%255,e}doWithGnpLockHeld(e){this.lockQueue.push(e),this.lockQueue.length>1||this.processLockQueue()}processLockQueue(){this.gnpLock.acquireGnpLock(this.transportId).subscribe((e=>{(0,this.lockQueue[0])((e=>{var t;const n=null===(t=this.hidChannel.findDescriptor(yt.GN_PROTOCOL,mt.DATA,xt.OUTPUT))||void 0===t?void 0:t.reportSize;if(!n)throw new ct("Cannot send GNP packets to this device.",ke.DEVICE_ERROR);const r=class{static attrFromTypeAndPayloadLength(e,t){return(e<<6)+(t+6)}static serialize(e){const t=new Uint8Array(6);t[0]=e.destination,t[1]=e.source,t[2]=e.sequenceNumber,t[3]=this.attrFromTypeAndPayloadLength(e.type,e.payload.length),t[4]=e.command,t[5]=e.subCommand;const n=new Uint8Array(t.length+e.payload.length);return n.set(t),n.set(e.payload,t.length),n}}.serialize(e);let i=0;do{const e=Math.min(r.length-i,n),t=r.subarray(i,i+e);i+=t.length,this.hidChannel.output(yt.GN_PROTOCOL,mt.DATA,Array.from(t))}while(i<r.length)}),this.packets,(()=>{this.gnpLock.releaseGnpLock(this.transportId,e),this.lockQueue.splice(0,1),this.lockQueue.length>0&&this.processLockQueue()}))}))}sendEvent(e,t,n=this.primaryAddress){const r=new It(n,_t.PC_ADDR,Rt.EVENT,e.command,e.subCommand,e.serialize(t),0);this.doWithGnpLockHeld(((e,t,n)=>{e(r),n()}))}read(e,t=this.primaryAddress,n=2500){const r=new Tt(e,(e=>new Uint8Array));return this.readWithParams(r,null,t,n)}readWithParams(e,t,n=this.primaryAddress,r=2500){const i=new It(n,_t.PC_ADDR,Rt.READ,e.command,e.subCommand,e.serialize(t),this.getNextSequenceNumber()),o=new F;return this.doWithGnpLockHeld(((t,n,s)=>{n.pipe(Jt(i),qt(),Ze((e=>e.command===i.command&&e.subCommand===i.subCommand)),Re(r),$t(s),Oe((t=>e.deserialize(t)))).subscribe(o),t(i)})),o}write(e,t,n=this.primaryAddress,r=2500){const i=new It(n,_t.PC_ADDR,Rt.WRITE,e.command,e.subCommand,e.serialize(t),this.getNextSequenceNumber()),o=new F;return this.doWithGnpLockHeld(((e,t,n)=>{t.pipe(Jt(i),qt(),Ze((e=>e.command===Nt.ACK)),Re(r),$t(n),Oe((()=>!0))).subscribe(o),e(i)})),o}}Xt.eventsFilter=e=>e.pipe(Ve((e=>e.type===Rt.EVENT)));class Qt{constructor(e,t){this.parentGnpChannel=e,this.primaryAddress=t,this.events=e.events.pipe(Ve((e=>e.source===this.primaryAddress)))}sendEvent(e,t,n){this.parentGnpChannel.sendEvent(e,t,this.primaryAddress)}read(e,t,n){return this.parentGnpChannel.read(e,this.primaryAddress,n)}readWithParams(e,t,n,r){return this.parentGnpChannel.readWithParams(e,t,this.primaryAddress,r)}write(e,t,n,r){return this.parentGnpChannel.write(e,t,this.primaryAddress,r)}}function Zt(e,t,n,r){if(!Xt.supportsGnpOverHid(e))return be((()=>new ct("Device does not support GNP commands.",ke.DEVICE_ERROR)));const i=ge(_t.HS_BT_USB_ADDR,_t.BASE_ADDR,_t.CRADLE_ADDR,_t.HS1_ADDR,_t.HS_CRADLE_ADDR).pipe(Oe(((r,i)=>De((()=>{const o=new Xt(e,new Mt(t),n,r,i),s=new Ut;return o.read(s,r,500).pipe(Oe((e=>o)),ze((()=>$)))})))),Ae(),Je(1),Xe((()=>new ct("GNP probe failed.",ke.DEVICE_ERROR))));return Ye(r.pipe(Te((e=>be((()=>new ct("Device was suddenly disconnected.",ke.DEVICE_ERROR)))))),i).pipe(nt())}function en(e,t){return new Qt(e,t)}class tn{constructor(){this.primaryAddress=_t.BASE_ADDR,this.events=Ge}subscribeToEvent(e,t){return be((()=>new ct("This device does not support GNP commands.",ke.FEATURE_NOT_SUPPORTED)))}sendEvent(e,t,n){throw new ct("This device does not support GNP commands.",ke.FEATURE_NOT_SUPPORTED)}read(e,t,n){return be((()=>new ct("This device does not support GNP commands.",ke.FEATURE_NOT_SUPPORTED)))}readWithParams(e,t,n,r){return be((()=>new ct("This device does not support GNP commands.",ke.FEATURE_NOT_SUPPORTED)))}write(e,t,n,r){return be((()=>new ct("This device does not support GNP commands.",ke.FEATURE_NOT_SUPPORTED)))}}class nn{constructor(e){this.transportId=e,this.isChild=!1}equals(e){return this.isChild===e.isChild&&this.transportId===e.transportId}toString(){return this.transportId}}class rn{constructor(e,t){this.parentId=e,this.gnpAddress=t,this.isChild=!0,this.transportId=e.transportId}equals(e){if(this.isChild===e.isChild){const t=e;return this.parentId.equals(t.parentId)&&this.gnpAddress===t.gnpAddress}return!1}toString(){return`0x${e=this.gnpAddress,e.toString(16).padStart(2,"0").toUpperCase()}@${this.transportId}`;var e}}var on,sn,an;!function(e){e.NO_TRACKING="no-tracking",e.TRACK_ERRORS="track-errors",e.TRACK_USAGE="track-usage",e.TRACK_ALL="track-all"}(on||(on={})),function(e){e[e.BLUETOOTH=0]="BLUETOOTH",e[e.INDIRECT=1]="INDIRECT",e[e.USB=2]="USB"}(sn||(sn={})),function(e){e[e.BASE=0]="BASE",e[e.HEADSET=1]="HEADSET",e[e.DESKSTAND=2]="DESKSTAND",e[e.OTHER=3]="OTHER",e[e.DONGLE=4]="DONGLE",e[e.PC=5]="PC",e[e.EHS=6]="EHS",e[e.USB=7]="USB",e[e.SPEAKER_PHONE=8]="SPEAKER_PHONE",e[e.INDICATOR=9]="INDICATOR",e[e.MOBILE=10]="MOBILE",e[e.NONE=11]="NONE",e[e.LOCAL=12]="LOCAL",e[e.DISPLAY=13]="DISPLAY",e[e.HS_CRADLE=14]="HS_CRADLE",e[e.HS_CRADLE2=15]="HS_CRADLE2",e[e.MOBILE_IAP=16]="MOBILE_IAP",e[e.CRADLE=17]="CRADLE",e[e.VIDEO=18]="VIDEO",e[e.NOT_GN=252]="NOT_GN",e[e.ANY_GN=253]="ANY_GN",e[e.NOT_INIT=254]="NOT_INIT",e[e.ANY=255]="ANY"}(an||(an={}));class cn{constructor(e,t,n,r,i,o,s,a,c,u,l){this.id=e,this.type=t,this.hidChannel=n,this.events=r,this.primaryAddress=i,this.sendEvent=o,this.read=s,this.readWithParams=a,this.write=c,this.onDisconnect=u,this.parentConnectionId=l,this.onDisconnect.subscribe({error:N})}static createConnection(e,t,n,r,i,o){const s=r.sendEvent.bind(r),a=r.read.bind(r),c=r.readWithParams.bind(r),u=r.write.bind(r);return new cn(e,t,n,r.events,r.primaryAddress,s,a,c,u,i,o)}}const un=(e=3,t=500)=>n=>n.pipe(Te(((n,r)=>{const i=r+1;return i>e?be((()=>n)):Se(i*i*t)})));function ln(e,t,n,r=1e3,i=3,o=100){return De((()=>e.read(t,n,r))).pipe(tt(un(i,o)))}function hn(e,t,n){const{deviceType:r,address:i}=n;return{transportId:t.transportId,vid:t.vid,pid:ln(e,Pt,i),name:ln(e,St,i),serialNumber:ln(e,kt,i),capabilities:t.capabilities,deviceType:r,connectionGnpAddress:i}}class dn{constructor(e,t,n=hn,r=cn.createConnection,i=en){this.parentConnection=t,this.connectionCreator=r,this.createChildGnpChannel=i;const o=t.events.pipe(Ve((e=>e.command===Nt.DEVICE&&e.subCommand===Ot.ATTACH_EVENT)),Oe((e=>({deviceType:e.payload[0],address:e.payload[1]})))).pipe(Oe(n.bind(null,t,e)));this.connectionEvents=o.pipe(Oe((e=>{const n=Ye(t.events.pipe(Ze((t=>t.command===Nt.DEVICE&&t.subCommand===Ot.DETACH_EVENT&&t.payload[1]===e.connectionGnpAddress)),Oe(N)),t.onDisconnect);return{attach:e,detach:n}})),Te((e=>je(ge(e.attach),this.createConnection(e.attach,e.detach)))),Oe((([e,t])=>({event:e,connection:t}))),st(t.onDisconnect)),t.sendEvent(At,[])}createConnection(e,t){const n=e.connectionGnpAddress,r=this.createChildGnpChannel(this.parentConnection,n),i=new rn(this.parentConnection.id,n);return ge(this.connectionCreator(i,sn.INDIRECT,this.parentConnection.hidChannel,r,t,this.parentConnection.id))}}const pn={command:Nt.IDENT,subCommand:Ot.TYPE,deserialize:e=>{const{payload:t}=e,n=t[0];if(n<1||n>=t.length)throw new ct("Cannot get device type.",ke.DEVICE_ERROR);return t[1]}};function fn(e,t,n,r=Le.ERROR,i=Ue.JS_LIB){ut(`${e} ${function(e){if(e instanceof ct){const t=e;return`JabraError: ${t.message} (type: ${t.type})`}if(e instanceof Error){const t=e;return`Error: ${t.message} (name: ${t.name})`}return`Unknown error: ${e}`}(t)}`,n,r,i)}function vn(e){return new dn(e.event,e.connection).connectionEvents}class En{constructor(e,t,n=((e,t,n)=>new Yt(e,t,n)),r=Zt,i=vn,o=cn.createConnection){this.transport=e,this.logger=t,this.createHidChannel=n,this.createRootGnpChannel=r,this.connectionCreator=o;const s=this.transport.consoleAppEvent.pipe(Ve((e=>"attach"===e.event)),Oe(En.createAttachEvent),ze(((e,t)=>(fn("",e,this.logger),t)))).pipe(Oe((e=>{const t=this.transport.consoleAppEvent.pipe(Ve((e=>"detach"===e.event)),Ze((t=>En.getTransportId(t)===e.transportId)),Oe(N),it());return t.subscribe(),{attach:e,detach:t}})),Te((e=>this.createConnection(e.attach,e.detach))),nt()),a=s.pipe(Ve((e=>e.event.deviceType===an.DONGLE)),Ve((e=>Xt.supportsGnpOverHid(e.connection.hidChannel))),Te((e=>i(e))));this.connectionEvents=Pe(s,a).pipe(nt())}static convertToReportType(e){switch(e){case"input":return xt.INPUT;case"output":return xt.OUTPUT;case"feature":return xt.FEATURE;default:throw new ct(`${e} is not a valid ReportType`,ke.UNEXPECTED_ERROR)}}static convertToValueType(e){switch(e){case"absolute":return Ft.ABSOLUTE;case"relative":return Ft.RELATIVE;default:throw new ct(`${e} Not a valid ValueType`,ke.UNEXPECTED_ERROR)}}static createDescriptor(e){return e.map((e=>({reportType:En.convertToReportType(e.reportType),usagePage:e.usagePage,usage:e.usage,valueType:En.convertToValueType(e.valueType),reportSize:e.reportSize})))}static getMandatoryField(e,t){const n=e[t];if(void 0===n)throw new ct(`JSON event lacks required field "${t}: ${JSON.stringify(e)}`,ke.UNEXPECTED_ERROR);return n}static getTransportId(e){return En.getMandatoryField(e,"id")}static createAttachEvent(e){return{transportId:En.getTransportId(e),vid:En.getMandatoryField(e,"vid"),pid:ge(En.getMandatoryField(e,"pid")),name:ge(En.getMandatoryField(e,"name")),serialNumber:ge(En.getMandatoryField(e,"serialNumber")),capabilities:En.createDescriptor(En.getMandatoryField(e,"descriptor"))}}createConnection(e,t,n=3,r=100){const{capabilities:i,transportId:o}=e,s=new nn(o),a=this.createHidChannel(s,i,this.transport),c=this.createRootGnpChannel(a,this.transport,o,t).pipe(ze(((e,t)=>(e.type&&e.type===ke.DEVICE_ERROR&&this.transport.context===xe.WEB_HID&&ut("Child devices are not yet supported when using WebHID.",this.logger,Le.WARNING,Ue.JS_LIB),ge(new tn)))),nt()),u=c.pipe(Te((e=>e.read(pn))),tt(un(n,r)),ze((e=>ge(an.ANY))));return je(c,u).pipe(st(t),Oe((([n,r])=>({event:Object.assign(Object.assign({},e),{deviceType:r,connectionGnpAddress:n.primaryAddress}),connection:this.connectionCreator(s,sn.USB,a,n,t)}))))}}var gn,bn,wn,yn,mn;class _n{constructor(e,t,n,r,s,a){this.vendorId=e,this.productId=t,this.serialNumber=n,this.name=r,this.type=s,bn.set(this,void 0),o(this,bn,new ht(a,i(_n,gn,"m",yn)),"f"),this.connectionAdded=i(this,bn,"f").itemAdded,this.connectionRemoved=i(this,bn,"f").itemRemoved,this.connectionList=i(this,bn,"f").itemList,this.onDisconnect=i(this,bn,"f").itemList.pipe(function(e){return Ve((function(t,n){return e<=n}))}(1),Ze((e=>0===e.length)),Oe(N),nt())}get id(){return Wt(this.vendorId,this.productId,this.serialNumber)}get currentConnections(){return i(this,bn,"f").getValue()}get browserLabel(){return`${this.vendorId.toString(16).padStart(4,"0")}:${this.productId.toString(16).padStart(4,"0")}`}}gn=_n,bn=new WeakMap,yn=function(e,t){return i(_n,gn,"f",wn).indexOf(e.type)-i(_n,gn,"f",wn).indexOf(t.type)},wn={value:[sn.USB,sn.INDIRECT,sn.BLUETOOTH]};class Rn{constructor(e){this.deviceObservables=new ht(e)}static exceptionToUndefined(e){try{return e()}catch(e){if(e instanceof ct)return;throw e}}connectionExists(e){return void 0!==Rn.exceptionToUndefined((()=>this.findConnectionById(e)))}findConnectionById(e){for(const t of this.deviceObservables.getValue())for(const n of t.currentConnections)if(n.id.equals(e))return n;throw new ct(`Could not find connection with id ${e.toString()}`,ke.UNEXPECTED_ERROR)}findDeviceByDeviceId(e){return this.deviceObservables.getValue().find((t=>t.id.startsWith(e)||e.startsWith(t.id)))}}class Nn{constructor(e,t){this.logger=t;const[n,r]=(i=e.pipe(Ve((e=>!this.deviceCollection.connectionExists(e.connection.id))),$e((e=>this.force(e)))),[Ve(o=({event:e,pid:t,serialNumber:n})=>!this.deviceCollection.findDeviceByDeviceId(Wt(e.event.vid,t,n)),s)(ce(i)),Ve(We(o,s))(ce(i))]);var i,o,s;const a=n.pipe(Oe((e=>Nn.createDevice(e,r))));this.deviceCollection=new Rn(a),this.deviceObservables=this.deviceCollection.deviceObservables}force(e){const{name:t,pid:n,serialNumber:r}=e.event,i=e.connection.onDisconnect.pipe((o=be((()=>new Error(`Connection with ID ${e.connection.id} disconnected`))),v(s)?$e((function(){return o}),s):$e((function(){return o}))));var o,s;return je(t,n,r).pipe(Oe((([t,n,r])=>({event:e,name:t,pid:n,serialNumber:r}))),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length?k((function(t,n){Ke(h([t],l(e)))(n)})):S}(i),ze((e=>(ut(`Failed to retrieve child connection information. Error: ${e}`,this.logger,Le.WARNING,Ue.JS_LIB),$))))}static createDevice(e,t){const{event:n,pid:r,name:i,serialNumber:o}=e,{vid:s,deviceType:a}=n.event,c=t.pipe(Ve((t=>Nn.isSameDevice(e,t))),Oe((e=>e.event.connection))),u=Ce(ge(n.connection),c);return new _n(s,r,o,i,a,u)}static isSameDevice(e,t){const n=Wt(e.event.event.vid,e.pid,e.serialNumber),r=Wt(t.event.event.vid,t.pid,t.serialNumber);return n.startsWith(r)||r.startsWith(n)}static create(e,t){const n=new En(e,t);return new Nn(n.connectionEvents)}}function On(e){var t,n,i;return r(this,void 0,void 0,(function*(){const r=null==e?void 0:e.logger;ut("Jabra SDK JS starting up...",r,Le.INFO);const o=new bt(e);o.validateOrganizationKey(),o.validateAppId(),o.validateAppName();const s=null!==(n=null===(t=null==e?void 0:e.internal)||void 0===t?void 0:t.testDeviceTransport)&&void 0!==n?n:yield vt(r,null==e?void 0:e.transport,null===(i=null==e?void 0:e.internal)||void 0===i?void 0:i.recorder);new Et(s,r);const a=Nn.create(s,r),c=new pt(a,s,e);return yield s.connect(),c}))}class Tn{constructor(e,t,n,r){this.deviceId=e,this.usagePage=t,this.usage=n,this.value=r}}class In{constructor(e,t){this.token=e,this.value=t}}!function(e){e.UsageReport=class{constructor(e,t){this.usage=e,this.value=t}}}(mn||(mn={}));var An,Cn,Dn,Sn,Pn,Ln,Un,kn,Hn,xn,Fn=Ht((function(e){!function(t){var n=function(e,t,n){if(!(e instanceof ArrayBuffer||"undefined"!=typeof Buffer&&e instanceof Buffer))throw new Error("Must specify a valid ArrayBuffer or Buffer.");t=t||0,n=n||e.byteLength||e.length,this._view=new Uint8Array(e.buffer||e,t,n),this.bigEndian=!1};n._scratch=new DataView(new ArrayBuffer(8)),Object.defineProperty(n.prototype,"buffer",{get:function(){return"undefined"!=typeof Buffer?Buffer.from(this._view.buffer):this._view.buffer},enumerable:!0,configurable:!1}),Object.defineProperty(n.prototype,"byteLength",{get:function(){return this._view.length},enumerable:!0,configurable:!1}),n.prototype._setBit=function(e,t){t?this._view[e>>3]|=1<<(7&e):this._view[e>>3]&=~(1<<(7&e))},n.prototype.getBits=function(e,t,n){var r=8*this._view.length-e;if(t>r)throw new Error("Cannot get "+t+" bit(s) from offset "+e+", "+r+" available");for(var i=0,o=0;o<t;){var s=t-o,a=7&e,c=this._view[e>>3],u=Math.min(s,8-a);this.bigEndian?(i<<=u,i|=c>>8-u-a&~(255<<u)):i|=(c>>a&~(255<<u))<<o,e+=u,o+=u}return n?(32!==t&&i&1<<t-1&&(i|=-1^(1<<t)-1),i):i>>>0},n.prototype.setBits=function(e,t,n){var r=8*this._view.length-e;if(n>r)throw new Error("Cannot set "+n+" bit(s) from offset "+e+", "+r+" available");for(var i=0;i<n;){var o,s,a,c=n-i,u=7&e,l=e>>3,h=Math.min(c,8-u);if(this.bigEndian){s=t>>n-i-h&(o=~(-1<<h));var d=8-u-h;a=~(o<<d),this._view[l]=this._view[l]&a|s<<d}else s=t&(o=~(255<<h)),t>>=h,a=~(o<<u),this._view[l]=this._view[l]&a|s<<u;e+=h,i+=h}},n.prototype.getBoolean=function(e){return 0!==this.getBits(e,1,!1)},n.prototype.getInt8=function(e){return this.getBits(e,8,!0)},n.prototype.getUint8=function(e){return this.getBits(e,8,!1)},n.prototype.getInt16=function(e){return this.getBits(e,16,!0)},n.prototype.getUint16=function(e){return this.getBits(e,16,!1)},n.prototype.getInt32=function(e){return this.getBits(e,32,!0)},n.prototype.getUint32=function(e){return this.getBits(e,32,!1)},n.prototype.getFloat32=function(e){return n._scratch.setUint32(0,this.getUint32(e)),n._scratch.getFloat32(0)},n.prototype.getFloat64=function(e){return n._scratch.setUint32(0,this.getUint32(e)),n._scratch.setUint32(4,this.getUint32(e+32)),n._scratch.getFloat64(0)},n.prototype.setBoolean=function(e,t){this.setBits(e,t?1:0,1)},n.prototype.setInt8=n.prototype.setUint8=function(e,t){this.setBits(e,t,8)},n.prototype.setInt16=n.prototype.setUint16=function(e,t){this.setBits(e,t,16)},n.prototype.setInt32=n.prototype.setUint32=function(e,t){this.setBits(e,t,32)},n.prototype.setFloat32=function(e,t){n._scratch.setFloat32(0,t),this.setBits(e,n._scratch.getUint32(0),32)},n.prototype.setFloat64=function(e,t){n._scratch.setFloat64(0,t),this.setBits(e,n._scratch.getUint32(0),32),this.setBits(e+32,n._scratch.getUint32(4),32)},n.prototype.getArrayBuffer=function(e,t){for(var n=new Uint8Array(t),r=0;r<t;r++)n[r]=this.getUint8(e+8*r);return n};var r=function(e,t){return function(){if(this._index+t>this._length)throw new Error("Trying to read past the end of the stream");var n=this._view[e](this._index);return this._index+=t,n}},i=function(e,t){return function(n){this._view[e](this._index,n),this._index+=t}};function o(e,t,n){if(0===t)return"";var r=0,i=[],o=!0,s=!!t;for(t||(t=Math.floor((e._length-e._index)/8));r<t;){var a=e.readUint8();if(0===a&&(o=!1,!s))break;o&&i.push(a),r++}var c=String.fromCharCode.apply(null,i);if(!n)return c;try{return decodeURIComponent(escape(c))}catch(e){return c}}var s=function(e,t,r){var i=e instanceof ArrayBuffer||"undefined"!=typeof Buffer&&e instanceof Buffer;if(!(e instanceof n||i))throw new Error("Must specify a valid BitView, ArrayBuffer or Buffer");this._view=i?new n(e,t,r):e,this._index=0,this._startIndex=0,this._length=8*this._view.byteLength};Object.defineProperty(s.prototype,"index",{get:function(){return this._index-this._startIndex},set:function(e){this._index=e+this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"length",{get:function(){return this._length-this._startIndex},set:function(e){this._length=e+this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bitsLeft",{get:function(){return this._length-this._index},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"byteIndex",{get:function(){return Math.ceil(this._index/8)},set:function(e){this._index=8*e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"buffer",{get:function(){return this._view.buffer},enumerable:!0,configurable:!1}),Object.defineProperty(s.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!1}),Object.defineProperty(s.prototype,"bigEndian",{get:function(){return this._view.bigEndian},set:function(e){this._view.bigEndian=e},enumerable:!0,configurable:!1}),s.prototype.readBits=function(e,t){var n=this._view.getBits(this._index,e,t);return this._index+=e,n},s.prototype.writeBits=function(e,t){this._view.setBits(this._index,e,t),this._index+=t},s.prototype.readBoolean=r("getBoolean",1),s.prototype.readInt8=r("getInt8",8),s.prototype.readUint8=r("getUint8",8),s.prototype.readInt16=r("getInt16",16),s.prototype.readUint16=r("getUint16",16),s.prototype.readInt32=r("getInt32",32),s.prototype.readUint32=r("getUint32",32),s.prototype.readFloat32=r("getFloat32",32),s.prototype.readFloat64=r("getFloat64",64),s.prototype.writeBoolean=i("setBoolean",1),s.prototype.writeInt8=i("setInt8",8),s.prototype.writeUint8=i("setUint8",8),s.prototype.writeInt16=i("setInt16",16),s.prototype.writeUint16=i("setUint16",16),s.prototype.writeInt32=i("setInt32",32),s.prototype.writeUint32=i("setUint32",32),s.prototype.writeFloat32=i("setFloat32",32),s.prototype.writeFloat64=i("setFloat64",64),s.prototype.readASCIIString=function(e){return function(e,t){return o(e,t,!1)}(this,e)},s.prototype.readUTF8String=function(e){return function(e,t){return o(e,t,!0)}(this,e)},s.prototype.writeASCIIString=function(e,t){!function(e,t,n){for(var r=n||t.length+1,i=0;i<r;i++)e.writeUint8(i<t.length?t.charCodeAt(i):0)}(this,e,t)},s.prototype.writeUTF8String=function(e,t){!function(e,t,n){for(var r=function(e){var t,n,r=[];for(t=0;t<e.length;t++)(n=e.charCodeAt(t))<=127?r.push(n):n<=2047?(r.push(n>>6|192),r.push(63&n|128)):n<=65535?(r.push(n>>12|224),r.push(n>>6&63|128),r.push(63&n|128)):(r.push(n>>18|240),r.push(n>>12&63|128),r.push(n>>6&63|128),r.push(63&n|128));return r}(t),i=n||r.length+1,o=0;o<i;o++)e.writeUint8(o<r.length?r[o]:0)}(this,e,t)},s.prototype.readBitStream=function(e){var t=new s(this._view);return t._startIndex=this._index,t._index=this._index,t.length=e,this._index+=e,t},s.prototype.writeBitStream=function(e,t){var n;for(t||(t=e.bitsLeft);t>0;)n=Math.min(t,32),this.writeBits(e.readBits(n),n),t-=n},s.prototype.readArrayBuffer=function(e){var t=this._view.getArrayBuffer(this._index,e);return this._index+=8*e,t},s.prototype.writeArrayBuffer=function(e,t){this.writeBitStream(new s(e),8*t)},e.exports&&(e.exports={BitView:n,BitStream:s})}()}));function Gn(){return r(this,void 0,void 0,(function*(){const{hid:e}=window.navigator;if(!e)throw new ct("WebHID not supported",ke.INIT_ERROR);const t=yield e.requestDevice({filters:[{vendorId:An.VENDOR_ID}]});return new BroadcastChannel(An.PAIRING_CHANNEL).postMessage(null),t}))}!function(e){e[e.VENDOR_ID=2830]="VENDOR_ID",e.PAIRING_CHANNEL="jabra-webhid-pairing-channel"}(An||(An={})),function(e){e[e.HOOK_SWITCH=32]="HOOK_SWITCH",e[e.GN_PSEUDO_HOOK_SWITCH=65531]="GN_PSEUDO_HOOK_SWITCH",e[e.FLASH=33]="FLASH",e[e.ALT_HOLD=35]="ALT_HOLD",e[e.REDIAL=36]="REDIAL",e[e.ONLINE=42]="ONLINE",e[e.SPEAKER_PHONE=43]="SPEAKER_PHONE",e[e.PHONE_MUTE=47]="PHONE_MUTE",e[e.SEND=49]="SEND",e[e.SPEED_DIAL=80]="SPEED_DIAL",e[e.VOICE_MAIL=112]="VOICE_MAIL",e[e.ANSWER_ON_OFF=116]="ANSWER_ON_OFF",e[e.LINE_BUSY=151]="LINE_BUSY",e[e.RINGER=158]="RINGER",e[e.PHONE_KEY_0=176]="PHONE_KEY_0",e[e.PHONE_KEY_1=177]="PHONE_KEY_1",e[e.PHONE_KEY_2=178]="PHONE_KEY_2",e[e.PHONE_KEY_3=179]="PHONE_KEY_3",e[e.PHONE_KEY_4=180]="PHONE_KEY_4",e[e.PHONE_KEY_5=181]="PHONE_KEY_5",e[e.PHONE_KEY_6=182]="PHONE_KEY_6",e[e.PHONE_KEY_7=183]="PHONE_KEY_7",e[e.PHONE_KEY_8=184]="PHONE_KEY_8",e[e.PHONE_KEY_9=185]="PHONE_KEY_9",e[e.PHONE_KEY_STAR=186]="PHONE_KEY_STAR",e[e.PHONE_KEY_POUND=187]="PHONE_KEY_POUND",e[e.ALT_VOLUME_UP=233]="ALT_VOLUME_UP",e[e.ALT_VOLUME_DOWN=234]="ALT_VOLUME_DOWN",e[e.REJECT_CALL=65533]="REJECT_CALL"}(Cn||(Cn={}));class Mn{constructor(e,t,n){this.type=e,this.value=t,this.valueType=n}toString(){return void 0===Cn[this.type]?`Unknown signal: type: ${this.type}, value: ${this.value}, valueType: ${this.valueType}`:`Signal: type: ${Cn[this.type]}, value: ${this.value}, valueType: ${this.valueType}`}}!function(e){e[e.BUTTON=9]="BUTTON",e[e.CONSUMER=12]="CONSUMER",e[e.LED=8]="LED",e[e.TELEPHONY=11]="TELEPHONY",e[e.GN_CONSUMER=65312]="GN_CONSUMER",e[e.GN_EXT_BUTTONS=65360]="GN_EXT_BUTTONS",e[e.GN_LED=65344]="GN_LED",e[e.GN_MISC=65376]="GN_MISC",e[e.GN_TELEPHONY=65328]="GN_TELEPHONY"}(Dn||(Dn={})),function(e){e[e.MUTE=9]="MUTE",e[e.OFF_HOOK=23]="OFF_HOOK",e[e.RING=24]="RING",e[e.MESSAGE_WAIT=25]="MESSAGE_WAIT",e[e.HOLD=32]="HOLD",e[e.MIC_MUTE=33]="MIC_MUTE",e[e.ONLINE=42]="ONLINE",e[e.HID_OFFLINE=43]="HID_OFFLINE"}(Sn||(Sn={})),function(e){e[e.HOOK_SWITCH=32]="HOOK_SWITCH",e[e.FLASH=33]="FLASH",e[e.HOLD=35]="HOLD",e[e.REDIAL=36]="REDIAL",e[e.ONLINE=42]="ONLINE",e[e.SPEAKER_PHONE=43]="SPEAKER_PHONE",e[e.MUTE=47]="MUTE",e[e.HID_SEND=49]="HID_SEND",e[e.SPEED_DIAL=80]="SPEED_DIAL",e[e.VOICE_MAIL=112]="VOICE_MAIL",e[e.ANSWER_ON_OFF=116]="ANSWER_ON_OFF",e[e.LINE_BUSY=151]="LINE_BUSY",e[e.RINGER=158]="RINGER",e[e.PHONE_KEY_0=176]="PHONE_KEY_0",e[e.PHONE_KEY_1=177]="PHONE_KEY_1",e[e.PHONE_KEY_2=178]="PHONE_KEY_2",e[e.PHONE_KEY_3=179]="PHONE_KEY_3",e[e.PHONE_KEY_4=180]="PHONE_KEY_4",e[e.PHONE_KEY_5=181]="PHONE_KEY_5",e[e.PHONE_KEY_6=182]="PHONE_KEY_6",e[e.PHONE_KEY_7=183]="PHONE_KEY_7",e[e.PHONE_KEY_8=184]="PHONE_KEY_8",e[e.PHONE_KEY_9=185]="PHONE_KEY_9",e[e.PHONE_KEY_STAR=186]="PHONE_KEY_STAR",e[e.PHONE_KEY_POUND=187]="PHONE_KEY_POUND",e[e.HID_ALT_VOLUME_UP=233]="HID_ALT_VOLUME_UP",e[e.HID_ALT_VOLUME_DOWN=234]="HID_ALT_VOLUME_DOWN",e[e.GN_PSEUDO_HOOK_SWITCH=65531]="GN_PSEUDO_HOOK_SWITCH",e[e.GN_OUT_OF_RANGE=65532]="GN_OUT_OF_RANGE",e[e.GN_REJECT_CALL=65533]="GN_REJECT_CALL",e[e.GN_TELEPHONY_CONT_SET=65535]="GN_TELEPHONY_CONT_SET"}(Pn||(Pn={}));class Bn{constructor(e,t,n,r,i){this.hidChannel=e,this.onDisconnect=t,this.isSoftphoneInFocus=n,this.lockHeld=r,this.logger=i,this.cachedSignals=new Map}setup(){const e=this.filter().pipe(nt());return e.subscribe(),e}filter(){const e=this.hidChannel.input.pipe(Ve((e=>e.usagePage===Dn.GN_TELEPHONY&&!e.isArray())),Te((e=>{const t=this.hidChannel.descriptor.find((t=>t.usagePage===e.usagePage&&t.usage===e.usage));return(null==t?void 0:t.valueType)?ge(Object.assign(Object.assign({},e),{valueType:t.valueType})):(fn("",new ct(`Unable to find value-type in descriptor for UsagePage: ${e.usagePage} and Usage: ${e.usage}`,ke.FEATURE_NOT_SUPPORTED),this.logger),$)})),Ve((e=>e.valueType===Ft.RELATIVE?Boolean(e.value):this.cachedSignals.get(e.usage)!==e.value)),at((e=>{this.cachedSignals.set(e.usage,e.value)})),st(this.onDisconnect),nt()),t=[Cn.HOOK_SWITCH,Cn.REDIAL],n=e.pipe(function(e){return t=>t.pipe(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=fe(e);return k((function(t,r){for(var i=e.length,o=new Array(i),s=e.map((function(){return!1})),a=!1,c=function(t){ce(e[t]).subscribe(new H(r,(function(e){o[t]=e,a||s[t]||(s[t]=!0,(a=s.every(S))&&(s=null))}),N))},u=0;u<i;u++)c(u);t.subscribe(new H(r,(function(e){if(a){var t=h([e],l(o));r.next(n?n.apply(void 0,h([],l(t))):t)}})))}))}(e),Ve((([e,t])=>t)),Oe((([e,t])=>e)))}(this.isSoftphoneInFocus),Ve((e=>t.includes(e.usage)&&!this.lockHeld.getValue())));return Pe(e.pipe(Ve((e=>this.lockHeld.getValue()))),n).pipe(Oe((e=>new Mn(e.usage,0!==e.value,e.valueType))),ze((e=>(ut(e.message,this.logger),$))))}}class Wn{constructor(e,t,n,r,s,a){this.device=e,this.onDisconnect=n,Ln.set(this,void 0),Un.set(this,new M(!1)),kn.set(this,void 0),Hn.set(this,!1),this.deviceSignals=new F,o(this,Ln,r,"f"),i(this,Ln,"f").lockHeld.subscribe(i(this,Un,"f")),o(this,kn,t,"f"),this.onDisconnect.pipe(Ze(),Oe((()=>!0))).subscribe((e=>{o(this,Hn,e,"f")}));const c=new Bn(i(this,kn,"f"),this.onDisconnect,s,i(this,Un,"f"),a);this.deviceSignals=c.setup()}checkCallLockHeld(e){if(!i(this,Un,"f").getValue())throw new ct(e,ke.SDK_USAGE_ERROR)}checkCallLockNotHeld(e){if(i(this,Un,"f").getValue())throw new ct(e,ke.SDK_USAGE_ERROR)}checkHasDisconnected(){if(i(this,Hn,"f"))throw new ct("CallControl cannot be performed as the connection has disconnected.",ke.SDK_USAGE_ERROR)}takeCallLock(){return this.checkHasDisconnected(),this.checkCallLockNotHeld("Trying to take the call lock, but it is already held!"),function(e,t){var n="object"==typeof t;return new Promise((function(r,i){var o,s=!1;e.subscribe({next:function(e){o=e,s=!0},error:i,complete:function(){s?r(o):n?r(t.defaultValue):i(new we)}})}))}(i(this,Ln,"f").tryTakeCallLock())}releaseCallLock(){this.checkHasDisconnected(),this.checkCallLockHeld("Trying to release the call lock, but it is not held!"),i(this,Ln,"f").releaseCallLock()}offHook(e){this.checkHasDisconnected(),this.checkCallLockHeld("Calls can only be started and stopped when the call lock is held.");const t=i(this,kn,"f").findDescriptor(Dn.GN_LED,Sn.OFF_HOOK,xt.OUTPUT);if(!t)throw new ct(`Device ${this.device.name} does not support any offHook functionality.`,ke.FEATURE_NOT_SUPPORTED);const n=e?1:0;i(this,kn,"f").output(t.usagePage,t.usage,n)}ring(e){this.checkHasDisconnected(),this.checkCallLockHeld("The ringer state can only be modified when the call lock is held.");const t=i(this,kn,"f").findDescriptor(Dn.GN_LED,Sn.RING,xt.OUTPUT),n=i(this,kn,"f").findDescriptor(Dn.GN_TELEPHONY,Pn.RINGER,xt.OUTPUT);if(!t&&!n)throw new ct(`Device ${this.device.name} does not support any ring functionality.`,ke.FEATURE_NOT_SUPPORTED);if(n){const t=e?1:0;i(this,kn,"f").output(n.usagePage,n.usage,t)}if(t){const n=e?1:0;i(this,kn,"f").output(t.usagePage,t.usage,n)}}mute(e){this.checkHasDisconnected(),this.checkCallLockHeld("The mute state can only be modified when the call lock is held.");let t=i(this,kn,"f").findDescriptor(Dn.GN_LED,Sn.MIC_MUTE,xt.OUTPUT);if(t||(t=i(this,kn,"f").findDescriptor(Dn.GN_LED,Sn.MUTE,xt.OUTPUT)),!t)throw new ct(`Device ${this.device.name} does not support any mute functionality.`,ke.FEATURE_NOT_SUPPORTED);const n=e?1:0;i(this,kn,"f").output(t.usagePage,t.usage,n)}hold(e){this.checkHasDisconnected(),this.checkCallLockHeld("The hold state can only be modified when the call lock is held.");const t=i(this,kn,"f").findDescriptor(Dn.GN_LED,Sn.HOLD,xt.OUTPUT);if(!t)throw new ct(`Device ${this.device.name} does not support hold functionality.`,ke.FEATURE_NOT_SUPPORTED);const n=e?1:0;i(this,kn,"f").output(t.usagePage,t.usage,n)}}Ln=new WeakMap,Un=new WeakMap,kn=new WeakMap,Hn=new WeakMap,function(e){e[e.STD_TELEPHONY=0]="STD_TELEPHONY",e[e.GN_TELEPHONY=1]="GN_TELEPHONY"}(xn||(xn={}));const Vn={[wt.SKYPE]:xn.GN_TELEPHONY,[wt.CISCO]:xn.GN_TELEPHONY,[wt.AVAYA]:xn.GN_TELEPHONY,[wt.SIEMENS]:xn.GN_TELEPHONY,[wt.IBM]:xn.GN_TELEPHONY,[wt.AASTRA]:xn.GN_TELEPHONY,[wt.JABRA]:xn.GN_TELEPHONY,[wt.NEC]:xn.GN_TELEPHONY,[wt.SHORETEL]:xn.GN_TELEPHONY,[wt.MS_OC]:xn.STD_TELEPHONY,[wt.ALCATEL]:xn.STD_TELEPHONY,[wt.OTHER]:xn.STD_TELEPHONY,[wt.NORTEL]:null,[wt.GENERIC]:null};class Yn{constructor(e,t,n){this.connectionCallLock=e,this.device=t,this.logger=n,this.lockHeld=new M(!1),this.currentLocks=new M(new Set),this.lockReleaseEvent=new F}tryTakeCallLock(){const{currentConnections:e}=this.device,t=new Set,n=De((()=>ae(e).pipe($e((e=>this.takeSingleCallLock(e).pipe(ze((e=>(fn("DeviceCallLock:",e,this.logger),ge(""))))))),at((e=>t.add(e)))))).pipe(function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Ve((function(t,n){return e(t,n,r)})):S,et(1),n?qe(t):Xe((function(){return new we})))}}(),Oe((n=>(t.delete(""),this.currentLocks.next(t),t.size!==e.length?(this.releaseCallLock(),!1):(this.lockHeld.next(!0),!0)))),it());return n.subscribe((e=>{e&&(this.acquireLockOnNextConnectionEmit(),this.releaseLockOnRemovedConnectionEmit())})),n}acquireLockOnNextConnectionEmit(){this.device.connectionAdded.pipe(st(this.lockReleaseEvent)).subscribe((e=>{this.takeSingleCallLock(e).pipe(st(this.lockReleaseEvent),Oe((e=>(this.currentLocks.getValue().add(e),this.currentLocks.next(this.currentLocks.getValue()),N))),tt(un())).subscribe({error:e=>{ut(`Failed to acquire the call lock on a new connection.\n              Another softphone running an old SDK has most likely acquired this lock.\n              Full error: ${e}`,this.logger,Le.WARNING,Ue.JS_LIB)}})}))}releaseLockOnRemovedConnectionEmit(){this.device.connectionRemoved.pipe(st(this.lockReleaseEvent)).subscribe((e=>this.releaseSingleCallLock(e.id.transportId)))}takeSingleCallLock(e){return De((()=>this.connectionCallLock.tryTakeCallLock(e.id.transportId))).pipe(Oe((t=>t.acquired?ge(t.transportId):be((()=>new ct(`Failed to acquire call lock on connection ${e.id.transportId}`,ke.SDK_USAGE_ERROR))))),ot())}releaseCallLock(){this.lockReleaseEvent.next(),[...this.currentLocks.getValue()].forEach((e=>{this.releaseSingleCallLock(e)})),this.currentLocks.getValue().clear(),this.currentLocks.next(this.currentLocks.getValue())}releaseSingleCallLock(e){this.connectionCallLock.releaseCallLock(e),this.currentLocks.getValue().delete(e),this.currentLocks.next(this.currentLocks.getValue()),0!==this.currentLocks.getValue().size&&0!==this.device.currentConnections.length||(this.lockReleaseEvent.next(),this.lockHeld.next(!1))}}class Kn{constructor(e){this.transport=e}tryTakeCallLock(e){const t={action:"request-call-lock",id:e};return this.transport.writeAction(t),this.transport.consoleAppEvent.pipe(Ve((t=>"response-call-lock"===t.event&&t.id===e)),Oe((e=>({transportId:e.id,acquired:e.acquired}))),Ze())}releaseCallLock(e){const t={action:"release-call-lock",id:e};this.transport.writeAction(t)}}const jn=[{usagePage:Dn.GN_LED,usage:Sn.OFF_HOOK,reportType:xt.OUTPUT},{usagePage:Dn.GN_LED,usage:Sn.RING,reportType:xt.OUTPUT},{usagePage:Dn.GN_TELEPHONY,usage:Pn.RINGER,reportType:xt.OUTPUT},{usagePage:Dn.GN_LED,usage:Sn.MIC_MUTE,reportType:xt.OUTPUT},{usagePage:Dn.GN_LED,usage:Sn.MUTE,reportType:xt.OUTPUT},{usagePage:Dn.GN_LED,usage:Sn.HOLD,reportType:xt.OUTPUT}],zn=[sn.USB,sn.INDIRECT,sn.BLUETOOTH];function $n(e){const{currentConnections:t,type:n}=e;var r;return(r=t,[...r].sort(((e,t)=>zn.indexOf(e.type)-zn.indexOf(t.type)))).find((e=>function(e,t){const{hidChannel:n}=e;return!!function(e){return jn.some((({usagePage:t,usage:n,reportType:r})=>e.findDescriptor(t,n,r)))}(n)&&(!Xt.supportsGnpOverHid(n)||t!==an.DONGLE&&t!==an.OTHER)}(e,n)))}class qn{constructor(e){this.devComm=e,this.softphoneInFocus=new L,this.softphoneInFocus=this.devComm.consoleAppEvent.pipe(Ve((e=>"softphone-in-focus"===e.event)),Oe((e=>e.infocus)),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ve(e);return k((function(t,r){(n?Ce(e,t,n):Ce(e,t)).subscribe(r)}))}(!1),it(1)),this.softphoneInFocus.subscribe((()=>{}))}setSharedSoftphoneInfo(e){if(!(null==e?void 0:e.partnerKey)||!(null==e?void 0:e.appId))return void ut("Unable to register with Jabra Direct: partnerKey or appId missing in config",null==e?void 0:e.logger,Le.WARNING);const t=e.partnerKey+e.appId,n=new Gt(5,"ns:OID",t);let{appName:r}=e;if((!e.appName||e.appName.length<3)&&(ut("App name missing in config. Fall back to use appId as app name.",null==e?void 0:e.logger,Le.WARNING),r=e.appId),r.length>100)return void ut("Unable to register with Jabra Direct: appName must be below 100 characters.",null==e?void 0:e.logger,Le.WARNING);const i={action:"set-softphone-info",name:r,id:n.toString()};this.devComm.writeAction(i)}}var Jn,Xn,Qn,Zn,er,tr,nr,rr;class ir{constructor(e){var t;Jn.set(this,void 0),Xn.set(this,void 0),Qn.set(this,void 0),Zn.set(this,void 0),o(this,Xn,new qn(e._transport),"f"),i(this,Xn,"f").setSharedSoftphoneInfo(e._config),o(this,Jn,e._transport,"f"),o(this,Qn,null===(t=e._config)||void 0===t?void 0:t.logger,"f"),o(this,Zn,e._readyEvents.pipe(Ze((e=>"ready"===e.event)),Oe((e=>e.jabraDirectInstalled))),"f")}createCallControl(e){return this.supportsCallControl(e)?ye(i(this,Zn,"f").pipe(Te((t=>function(e,t,n,r,i){const o=$n(e),{hidChannel:s,onDisconnect:a}=o,c=new Yn(new Kn(r),e,i);return t||r.context===xe.WEB_HID?ge(new Wn(e,s,a,c,n.softphoneInFocus,i)):function(e,t){return e.findDescriptor(Dn.GN_TELEPHONY,Pn.GN_TELEPHONY_CONT_SET,xt.FEATURE)?De((()=>(e.setFeatureReport(Dn.GN_TELEPHONY,Pn.GN_TELEPHONY_CONT_SET,1),ge(!0)))):t?function(e,t){const n=e.read(new Lt).pipe(Oe((e=>Vn[e]===t))),r=e.read(new Dt).pipe(Oe((e=>e.find((e=>Vn[e]===t))))).pipe(Oe((t=>t?e.write(new Lt,t):ge(!1))),ot());return n.pipe((i=ge(!0),o=r,e=>e.pipe(Oe((e=>e?i:o)),ot())));var i,o}(t,xn.GN_TELEPHONY):ge(!1)}(s,o).pipe(Oe((t=>new Wn(e,s,a,c,n.softphoneInFocus,i))))}(e,t,i(this,Xn,"f"),i(this,Jn,"f"),i(this,Qn,"f")))))):Promise.reject(new ct(`Device ${e.name} does not support call control.`,ke.FEATURE_NOT_SUPPORTED))}supportsCallControl(e){return void 0!==$n(e)}}Jn=new WeakMap,Xn=new WeakMap,Qn=new WeakMap,Zn=new WeakMap,function(e){e.HOLD_CURRENT="hold-current",e.END_CURRENT="end-current"}(er||(er={})),function(e){e.MUTED="muted",e.UNMUTED="unmuted",e.NO_ONGOING_CALLS="no-ongoing-calls"}(tr||(tr={})),function(e){e.ON_HOLD="on-hold",e.NOT_ON_HOLD="not-on-hold",e.NO_ONGOING_CALLS="no-ongoing-calls"}(nr||(nr={})),function(e){e.NO_INCOMING="no-incoming",e.AWAITING_RESPONSE="awaiting-response",e.RESOLVING_RESPONSE="resolving-response",e.ACCEPTED="accepted",e.REJECTED="rejected"}(rr||(rr={})),new WeakMap,new WeakMap,tr.NO_ONGOING_CALLS,nr.NO_ONGOING_CALLS,rr.NO_INCOMING,new WeakMap,new WeakMap,new WeakMap,new WeakMap},290:(e,t,n)=>{n.r(t),n.d(t,{initHandler:()=>R});var r=n(525);function i(e,t){return t?function(n){return(0,r.c)(t.pipe((0,r.t)(1),(0,r.o)((function(e,t){e.subscribe(new r.O(t,r.n))}))),n.pipe(i(e)))}:(0,r.a)((function(t,n){return e(t,n).pipe((0,r.t)(1),function(e){return(0,r.m)((function(){return e}))}(t))}))}function o(e,t){void 0===t&&(t=r.d);var n=(0,r.b)(e,t);return i((function(){return n}))}class s{static rawUsageFrom(e,t){return(e<<16|t)>>>0}static usagePageFromRaw(e){return e>>>16}static usageFromRaw(e){return e<<16>>>16}}class a{constructor(e){this.devices=new Map,this.deviceInputSubscriptions=new Map,this.onHidInput=new r.S,this.onGetFeatureReportResponse=new r.S;const t=new r.S;this.deviceAdded=t;const n=new r.S;this.deviceRemoved=n,e.deviceAdded.subscribe((e=>{if(!this.devices.has(e.id)){this.devices.set(e.id,e);const n=e.inputHandler.inputReports.pipe((0,r.m)((t=>new r.W(e.id,s.usagePageFromRaw(t.usage),s.usageFromRaw(t.usage),t.value)))).subscribe((e=>this.onHidInput.next(e)));this.deviceInputSubscriptions.set(e.id,n),t.next(e)}})),e.deviceRemoved.subscribe((e=>{var t;const r=this.devices.get(e);r&&(this.devices.delete(e),null===(t=this.deviceInputSubscriptions.get(e))||void 0===t||t.unsubscribe(),this.deviceInputSubscriptions.delete(e),n.next(r))}))}sendOutputUsage(e,t,n,r){var i;const o=s.rawUsageFrom(t,n);null===(i=this.devices.get(e))||void 0===i||i.outputHandler.sendOutputUsage(o,r)}setFeatureUsage(e,t,n,r){var i;const o=s.rawUsageFrom(t,n);null===(i=this.devices.get(e))||void 0===i||i.featureHandler.setFeatureUsage(o,r)}getFeatureUsage(e,t,n,i){var o;return(0,r._)(this,void 0,void 0,(function*(){const a=s.rawUsageFrom(n,i),c=yield null===(o=this.devices.get(e))||void 0===o?void 0:o.featureHandler.getFeatureUsage(a);void 0!==c&&this.onGetFeatureReportResponse.next(new r.e(t,c))}))}}class c{constructor(e,t){this.device=e,this.inputReportDescriptors=t;const n=new Map;this.inputReportDescriptors.forEach((e=>{e.usages.forEach(((e,t)=>{n.set(t,[0])}))}));const i=new r.S;this.inputReports=i,this.device.oninputreport=e=>{if(e.currentTarget!==this.device)return;const t=this.inputReportDescriptors.get(e.reportId);if(!t)return;const o=new r.f.BitView(e.data.buffer);o.bigEndian=!1,Array.from(t.usages.entries(),c.makeWebHidInputReport.bind(this,o)).filter((e=>c.compareReportToCachedValue(e,n))).forEach((e=>{n.set(e.usage,e.value),i.next(e)}))}}static makeWebHidInputReport(e,[t,n]){let i=n.offset,o=n.size,s=[];for(;o>0;)s.push(e.getBits(i,Math.min(o,8))),i+=8,o-=8;return s=n.onInput(s),new r.I.UsageReport(t,s)}static compareReportToCachedValue(e,t){const n=t.get(e.usage);return!n||n.length!==e.value.length||n.some(((t,n)=>e.value[n]!==t))}}class u{constructor(e){this.report=e}reportSizeInBits(){return this.report.fullReportSize}reportSizeInBytes(){return Math.ceil(this.reportSizeInBits()/8)}createBitViewIfNeeded(){if(!this.bitView){const e=this.reportSizeInBytes(),t=new ArrayBuffer(e);this.bitView=new r.f.BitView(t),this.bitView.bigEndian=!1}return this.bitView}getUsageInformationOrThrow(e){if(!this.report.usages.has(e))throw new r.J(`Unable to write usage (0x${e.toString(16).padStart(8,"0")}). It is not known by the device.`,r.E.UNEXPECTED_ERROR);return this.report.usages.get(e)}writeUsage(e,t){const n=this.getUsageInformationOrThrow(e);let i=this.createBitViewIfNeeded();if(!n.absolute){const e=function(e){const t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}(i.buffer);i=new r.f.BitView(e)}let o=n.offset,s=n.size;return t.forEach((e=>{i.setBits(o,e,s),o+=8,s-=8})),i.buffer}}class l{constructor(e,t,n){this.device=e,this.outputReports=t,this.outputUsages=n,this.outputCacheByReportId=new Map}getReportIdForUsage(e){if(!this.outputUsages.has(e))throw new r.J(`Unknown usagePage: 0x${e.toString(16).padStart(8,"0")}.`,r.E.UNEXPECTED_ERROR);return this.outputUsages.get(e)}getReportLayoutForReportId(e){if(!this.outputReports.has(e))throw new r.J(`Unknown reportId: ${e}.`,r.E.UNEXPECTED_ERROR);return this.outputReports.get(e)}getUsageInReportForUsage(e){const t=this.getReportIdForUsage(e),n=this.getReportLayoutForReportId(t);if(!n.usages.has(e))throw new r.J(`Unknown rawUsage inside ReportLayout: ${e}.`,r.E.UNEXPECTED_ERROR);return n.usages.get(e)}getOrCreateCacheForReportId(e){if(!this.outputCacheByReportId.has(e)){const t=this.getReportLayoutForReportId(e),n=new u(t);this.outputCacheByReportId.set(e,n)}return this.outputCacheByReportId.get(e)}sendOutputUsage(e,t){return(0,r._)(this,void 0,void 0,(function*(){const n=this.getReportIdForUsage(e),r=this.getOrCreateCacheForReportId(n),i=this.getUsageInReportForUsage(e).onOutput(t),o=r.writeUsage(e,i);yield this.device.sendReport(n,o)}))}}class h{constructor(e=new Map,t=0){this.usages=e,this.fullReportSize=t}}class d{constructor(e,t,n){this.offset=e,this.size=t,this.absolute=n}onInput(e){return e}onOutput(e){return e}}class p{constructor(e,t,n,r){this.offset=e,this.size=t,this.absolute=n,this.rangeIndex=r}onInput(e){if(e.length>1)throw new r.J(`Usages of type ${p.name} should not hold more than 1 byte of information.`,r.E.UNEXPECTED_ERROR);return e[0]===this.rangeIndex?[1]:[0]}onOutput(e){if(e.length>1)throw new r.J(`Usages of type ${p.name} should not hold more than 1 byte of information.`,r.E.UNEXPECTED_ERROR);return e[0]>0?[this.rangeIndex]:e}}class f{constructor(e){const t=new Map;this.buildReportLayouts(e.collections,"input",t),this.inputReports=t,this.inputUsages=f.buildUsageMap(t);const n=new Map;this.buildReportLayouts(e.collections,"output",n),this.outputReports=n,this.outputUsages=f.buildUsageMap(n);const r=new Map;this.buildReportLayouts(e.collections,"feature",r),this.featureReports=r,this.featureUsages=f.buildUsageMap(r)}static buildUsageMap(e){const t=new Map;return e.forEach(((e,n)=>{e.usages.forEach(((e,r)=>{t.set(r,n)}))})),t}buildReportLayouts(e,t,n){e.forEach((e=>{var r;null===(r=f.reportsOfType(e,t))||void 0===r||r.forEach((e=>{var t;const r=e.reportId;n.has(r)||n.set(r,new h);const i=n.get(r);let o=0;null===(t=e.items)||void 0===t||t.forEach((e=>{let t=e.usages;if(e.isRange){t=[];for(let n=e.usageMinimum;n<=e.usageMaximum;n+=1)t.push(n)}let n,r=o;if(e.isRange&&e.isArray&&(n=1),t.length>0&&t.filter((e=>i.usages.has(e))).length===t.length)return;t.forEach((t=>{let o;o=n?new p(r,e.reportSize,e.isAbsolute,n):new d(r,e.reportSize,e.isAbsolute),i.usages.set(t,o),n?n+=1:r+=e.reportSize}));const s=e.reportCount*e.reportSize;i.fullReportSize+=s,o+=s}))})),e.children&&this.buildReportLayouts(e.children,t,n)}))}static reportsOfType(e,t){if("input"===t)return e.inputReports;if("output"===t)return e.outputReports;if("feature"===t)return e.featureReports;throw new r.J(`Unexpected report type: ${t}!`,r.E.UNEXPECTED_ERROR)}}class v{constructor(e,t,n){this.device=e,this.featureReports=t,this.featureUsages=n,this.outputCacheByReportId=new Map}getReportIdForUsage(e){if(!this.featureUsages.has(e))throw new r.J(`Unknown usagePage: 0x${e.toString(16).padStart(8,"0")}.`,r.E.UNEXPECTED_ERROR);return this.featureUsages.get(e)}getReportLayoutForReportId(e){if(!this.featureReports.has(e))throw new r.J(`Unknown reportId: ${e}.`,r.E.UNEXPECTED_ERROR);return this.featureReports.get(e)}getUsageInReportForUsage(e){const t=this.getReportIdForUsage(e),n=this.getReportLayoutForReportId(t);if(!n.usages.has(e))throw new r.J(`Unknown rawUsage inside ReportLayout: ${e}.`,r.E.UNEXPECTED_ERROR);return n.usages.get(e)}getOrCreateCacheForReportId(e){if(!this.outputCacheByReportId.has(e)){const t=this.getReportLayoutForReportId(e),n=new u(t);this.outputCacheByReportId.set(e,n)}return this.outputCacheByReportId.get(e)}getFeatureUsage(e){return(0,r._)(this,void 0,void 0,(function*(){const t=this.getReportIdForUsage(e),n=yield this.device.receiveFeatureReport(t),r=this.getUsageInReportForUsage(e),i=[];for(let e=1;e<=Math.ceil(r.size/8);e+=1)i.push(n.getUint8(e));return i}))}setFeatureUsage(e,t){return(0,r._)(this,void 0,void 0,(function*(){const n=this.getReportIdForUsage(e),r=this.getOrCreateCacheForReportId(n),i=this.getUsageInReportForUsage(e).onOutput(t),o=r.writeUsage(e,i);yield this.device.sendFeatureReport(n,o)}))}}class E{constructor(e,t,n,r){this.name=e,this.vid=t,this.pid=n,this.id=r.sessionId;const i=new f(r);this.inputReports=i.inputReports,this.outputReports=i.outputReports,this.featureReports=i.featureReports,this.inputHandler=new c(r,i.inputReports),this.outputHandler=new l(r,i.outputReports,i.outputUsages),this.featureHandler=new v(r,i.featureReports,i.featureUsages)}}class g{constructor(e,t){this.hid=e,this.broadcastChannel=t,this.deviceAddedSubject=new r.S,this.deviceAdded=this.deviceAddedSubject,this.deviceRemovedSubject=new r.S,this.deviceRemoved=this.deviceRemovedSubject}setupListeners(){this.hid.onconnect=e=>this.onConnect(e),this.hid.ondisconnect=e=>this.onDisconnect(e),this.broadcastChannel.onmessage=()=>this.getPairedDevices()}addNewDevice(e){return(0,r._)(this,void 0,void 0,(function*(){if(g.hasGeneratedDeviceId(e))return;g.getOrGenerateDeviceId(e);const t=new E(e.productName,e.vendorId,e.productId,e);e.opened||(yield e.open()),this.deviceAddedSubject.next(t)}))}onConnect(e){return(0,r._)(this,void 0,void 0,(function*(){setTimeout((()=>(0,r._)(this,void 0,void 0,(function*(){yield this.addNewDevice(e.device)}))),1e3)}))}onDisconnect(e){const t=g.getOrGenerateDeviceId(e.device);this.deviceRemovedSubject.next(t)}getPairedDevices(){return(0,r._)(this,void 0,void 0,(function*(){(yield this.hid.getDevices()).forEach((e=>(0,r._)(this,void 0,void 0,(function*(){yield this.addNewDevice(e)}))))}))}static hasGeneratedDeviceId(e){return void 0!==e.sessionId}static getOrGenerateDeviceId(e){if(!g.hasGeneratedDeviceId(e)){const t=new r.u(4).toString();return e.sessionId=t,t}return e.sessionId}}class b{constructor(e,t,n,r,i){this.usagePage=e,this.usage=t,this.valueType=n,this.reportType=r,this.reportSize=i}}class w{constructor(e){this.deviceManagement=e,this.events=new r.S,this.setupDeviceHandler()}setupDeviceHandler(){this.deviceManagement.deviceAdded.subscribe((e=>{this.events.next({event:"attach",id:e.id,vid:e.vid,pid:e.pid,name:e.name,serialNumber:e.id,descriptor:w.generateDescriptors(e)})})),this.deviceManagement.deviceRemoved.subscribe((e=>{this.events.next({event:"detach",id:e.id})})),this.deviceManagement.onHidInput.subscribe((e=>{const t=1===e.value.length?e.value[0]:e.value;this.events.next({event:"hid-input",id:e.deviceId,usagePage:e.usagePage,usage:e.usage,value:t})})),this.deviceManagement.onGetFeatureReportResponse.subscribe((e=>{const t=1===e.value.length?e.value[0]:e.value;this.events.next({event:"response-hid-feature",token:e.token,value:t})}))}static generateDescriptors(e){let t=w.convertReportLayoutsToDescriptors(e.inputReports,"input");return t=t.concat(w.convertReportLayoutsToDescriptors(e.outputReports,"output")),t=t.concat(w.convertReportLayoutsToDescriptors(e.featureReports,"feature")),t}static convertReportLayoutsToDescriptors(e,t){const n=[];return e.forEach((e=>{e.usages.forEach(((e,r)=>{const i=s.usagePageFromRaw(r);65280===i&&"output"===t||n.push(new b(i,s.usageFromRaw(r),e.absolute?"absolute":"relative",t,Math.ceil(e.size/8)))}))})),n}}class y{constructor(e,t,n){this.deviceManagement=e,this.callLockManagement=t,this.logger=n,this.gnpLockAcquired=new r.S,this.callLockAcquired=new r.S,this.softphoneInFocus=new r.S,this.events=(0,r.g)(this.gnpLockAcquired.pipe(o(0)),this.callLockAcquired.pipe(o(0)),this.softphoneInFocus)}onNewSdkInput(e){if(!e.action)throw new r.J("Provided input has no action property.",r.E.UNEXPECTED_ERROR);switch(e.action){case"hid-output":{const t=Array.isArray(e.value)?e.value:[e.value];this.deviceManagement.sendOutputUsage(e.id,e.usagePage,e.usage,t);break}case"request-hid-feature":this.deviceManagement.getFeatureUsage(e.id,e.token,e.usagePage,e.usage);break;case"set-hid-feature":{const t=Array.isArray(e.value)?e.value:[e.value];this.deviceManagement.setFeatureUsage(e.id,e.usagePage,e.usage,t);break}case"request-gnp-lock":this.gnpLockAcquired.next({event:"response-gnp-lock",token:e.token}),(0,r.l)("GNP lock requested with WebHID backend. This should not happen!",this.logger,r.L.ERROR,r.h.NATIVE_CONSOLE);break;case"release-gnp-lock":break;case"request-call-lock":this.callLockManagement.tryAcquireCallLock(e.id).then((t=>{this.callLockAcquired.next({event:"response-call-lock",id:e.id,acquired:t})}));break;case"release-call-lock":this.callLockManagement.releaseCallLock(e.id);break;case"set-softphone-info":this.softphoneInFocus.next({event:"softphone-in-focus",infocus:!1}),this.softphoneInFocus.complete();break;default:throw new r.J(`Provided action is not recognized - ${e.action}.`,r.E.UNEXPECTED_ERROR)}}}class m{constructor(e,t,n){this.navigatorLocks=e,this.logger=n,this.releaseGlobalLock=null,this.localLockedDevices=new Set,t.deviceRemoved.subscribe((e=>{this.localLockedDevices.has(e.id)&&this.releaseCallLock(e.id)}))}tryAcquireCallLock(e){return(0,r._)(this,void 0,void 0,(function*(){return!(yield this.checkWebLocksSupport())||(this.localLockedDevices.size>0&&!this.localLockedDevices.has(e)?(this.localLockedDevices.add(e),!0):new Promise((t=>{this.navigatorLocks.request("jabra-call-lock",{ifAvailable:!0},(n=>n?(this.localLockedDevices.add(e),t(!0),new Promise((e=>{this.releaseGlobalLock=e}))):(t(!1),Promise.resolve())))})))}))}releaseCallLock(e){this.localLockedDevices.delete(e),this.releaseGlobalLock&&0===this.localLockedDevices.size&&this.releaseGlobalLock()}checkWebLocksSupport(){return(0,r._)(this,void 0,void 0,(function*(){const e=yield this.navigatorLocks.query().catch((()=>{(0,r.l)("WebLocks unsupported. The cross-tab call lock is disabled.",this.logger,r.L.WARNING)}));return Boolean(e)}))}}class _{constructor(e,t,n,i){this.scanner=e,this.deviceEventHandler=t,this.sdkInputEventHandler=n,this.logger=i,this.readyEvent=new r.S,this.events=new r.i,this.events=(0,r.g)(this.readyEvent,this.deviceEventHandler.events,this.sdkInputEventHandler.events)}start(){this.readyEvent.next({event:"ready",version:null,jabraDirectInstalled:!1}),this.readyEvent.complete(),this.scanner.getPairedDevices(),this.scanner.setupListeners()}sendMessage(e){var t;null===(t=this.sdkInputEventHandler)||void 0===t||t.onNewSdkInput(e)}}function R(e){if("undefined"==typeof window)throw new r.J("WebHID is not supported outside of a browser environment.",r.E.INIT_ERROR);if(void 0===window.navigator||void 0===window.navigator.hid)throw new r.J("WebHID is not supported on this platform/browser.",r.E.INIT_ERROR);if(void 0===window.navigator.locks)throw new r.J("WebLocks is not supported on this platform/browser.",r.E.INIT_ERROR);const t=window.navigator.hid,n=window.navigator.locks,i=new BroadcastChannel(r.j.PAIRING_CHANNEL),o=new g(t,i),s=new a(o),c=new w(s),u=new y(s,new m(n,s,e));return new _(o,c,u,e)}},685:(e,t,n)=>{n.r(t),n.d(t,{WebHidTransport:()=>i});var r=n(525);class i{constructor(e,t,n){this.webHidHandler=e,this.logger=t,this.recorder=n,this.events=new r.S,this.consoleAppEvent=this.events,this.webHidConnected=!1,this.context=r.T.WEB_HID}connect(){return this.webHidConnected?Promise.reject(new r.J("Already connected",r.E.UNEXPECTED_ERROR)):(this.webHidHandler.events.subscribe((e=>{var t;let n=e;this.recorder&&(n=null===(t=this.recorder)||void 0===t?void 0:t.recordInput(n)),this.events.next(n)})),this.webHidHandler.start(),this.webHidConnected=!0,Promise.resolve())}writeAction(e){var t;if(!this.webHidConnected){const e="WebHID is uninitialized.";throw(0,r.l)(e,this.logger,r.L.ERROR),new r.J(e,r.E.INIT_ERROR)}null===(t=this.recorder)||void 0===t||t.recordOutput(e),this.webHidHandler.sendMessage(e)}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e=n(525),t=n(780),r=n.n(t);let i=null;chrome.runtime.onMessage.addListener((function(t,n,r){if(t&&"consent"===t.type){var i=document.createElement("div");i.id="jabraConsentID",i.innerHTML='<div id="JumpToModal" class="modal in" style="z-index: 99999; display: block;"> <div class="modal-centered modal-centered-lg" style="height: auto; min-height: auto; transform: translate(-50%, 0px); top: 10%;"> <div class="p-8"> <h4 class="mb-4">Is your Jabra headset connected to your PC?</h4> <button id="JabraConsentYes" class="btn btn-sm rounded b-a b-2x pointer mt-4" style="color: rgb(116, 121, 142);"> Yes </button> <button id="JabraConsentNo" class="btn btn-sm rounded b-a b-2x pointer mt-4" style="color: rgb(116, 121, 142);"> No </button> </div> </div></div><div class="modal-backdrop in"></div>',document.body.appendChild(i),document.body.classList.add("modal-open"),document.getElementById("JabraConsentYes").onclick=()=>{document.body.classList.remove("modal-open"),document.body.removeChild(i),(0,e.w)()},document.getElementById("JabraConsentNo").onclick=()=>{document.body.classList.remove("modal-open"),document.body.removeChild(i)}}r(!0)}));const o=async e=>new Promise((async(t,n)=>{const r=setTimeout((()=>{console.log("getLock timeout"),t(!1)}),5e3);try{const n=await e.takeCallLock();clearTimeout(r),t(n)}catch(e){t(!1)}})),s=e=>{try{return e.checkHasDisconnected(),!0}catch(e){return console.log("Device connection lost"),!1}},a=async t=>new Promise((async(n,i)=>{console.log("Waiting for device signal");const o=t.deviceSignals.subscribe((t=>{console.log(e.k[t.type],t),t.value&&e.k.HOOK_SWITCH===t.type&&c(),t.value||e.k.ONLINE!==t.type||u()}));for(;s(t);)await r()(100);s(t)&&(t.releaseCallLock(),o.unsubscribe()),n()})),c=()=>{console.log("Device hook trigger");let e=null,t=null;const n=document.getElementsByClassName("material-icons");for(let r of n)"call"===r.textContent&&null!==r.offsetParent&&(e=r.parentNode),"call_end"===r.textContent&&null!==r.offsetParent&&r.parentNode.classList.contains("call-action-icon-red")&&(t=r.parentNode);e?(e.click(),console.log("Pickup successfull")):t?(t.click(),console.log("Hangup successfull")):console.log("Phone window not visible")},u=()=>{let e=null;const t=document.getElementsByClassName("material-icons");for(let n of t)"call_end"===n.textContent&&null!==n.offsetParent&&n.parentNode.classList.contains("call-action-icon-red")&&(e=n.parentNode);e?(e.click(),console.log("Hangup successfull")):console.log("Phone window not visible for hangup")};(async()=>{for(await(async()=>{i=await(0,e.v)({transport:e.p.WEB_HID}),console.log("Made connection with Jabra chrome extension")})();;){const t=await new Promise(((t,n)=>{console.log("Waiting for jabra device");const r=i.deviceList.subscribe((async n=>{if(n.length>0){const o=n[0];console.log(`Jabra device found found ${o.name} - ${o.productId}`);const s=await(async t=>new Promise((async(n,r)=>{const o=setTimeout((()=>{console.log("getCallControll timeout"),n(null)}),5e3);try{const r=new e.C(i),s=await r.createCallControl(t);clearTimeout(o),n(s)}catch(e){n(null)}})))(o);r.unsubscribe(),t(s)}}))}));t&&await o(t)?(console.log("Device lock successfull"),await a(t)):(console.log("Cannot get a lock, trying again in 10 sec"),await r()(1e4))}})()})()})();